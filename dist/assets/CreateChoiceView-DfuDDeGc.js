import{d as O,u as P,b as L,a as j,v as z,r as d,x as I,o as R,c as $,P as G,e as H,f as J,w as K,y as W,g as u,h as e,t as i,i as a,j as c,F as k,k as X,p as _,A as y,af as Y,m as x,B as V,ag as Z,C as M,s as ee}from"./index-B1zD-M5g.js";import{a as te,b as se}from"./testService-CFPtsndb.js";import{Q as N}from"./Question-DJVAB3JS.js";import{_ as oe}from"./AppContainer.vue_vue_type_script_setup_true_lang-5ZPq4PI3.js";import"./firestore-qVOR4QEO.js";const ie={class:"app-main"},ae={class:"choice-form"},ne={class:"choice-form-title mb-4"},le={key:0,class:"alert alert-danger",role:"alert"},re={class:"mb-3 question-text"},ue={class:"mb-3"},ce={for:"choice-input-text",class:"form-label"},de=["type","disabled"],ve={key:0,class:"invalid-feedback is-invalid"},pe={class:"mb-3"},me={for:"choice-input-pts",class:"form-label"},he=["disabled"],fe={key:0,class:"invalid-feedback is-invalid"},be={class:"mb-3"},_e={class:"form-check"},ye={class:"form-check-label",for:"choice-input-correctness"},Ce={class:"mb-3"},ke={for:"choice-input-position",class:"form-label"},xe=["data-bs-content"],qe=["disabled"],ge={key:0,class:"invalid-feedback is-invalid"},Se=["disabled"],we=O({__name:"CreateChoiceView",props:{test_id:{},question_id:{}},setup(v){const T=W(),{t:s}=P(),{showMessage:q}=L(),{auth:A}=j(),{spaceLabel:B}=z(),{question:p,loadQuestion:Q}=te(),{addChoice:U}=se(),m=d(""),h=d(0),C=d(!1),f=d(0),g=d(!1),r=d(!1),b=d([]),n=I(()=>{const t={};return g.value&&(m.value===""&&(t.text=s("Choice required")),typeof h.value=="string"&&(t.points=s("Max points must be a number")),typeof f.value=="string"&&(t.position=s("The position must be a number"))),t}),D=R(A,async()=>{try{if(await Q(v.test_id,v.question_id),!p.value){q("failure",s("Question Not Found."));return}}catch{q("failure",s("Error loading question."))}finally{}}),S=[];$(()=>{document.querySelectorAll(".app-main .label-info").forEach(o=>{S.push(new G(o,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),H(()=>{S.forEach(t=>t.dispose()),D()});async function F(){var t;if(!r.value){if(r.value=!0,g.value=!0,Object.keys(n.value).length>0){r.value=!1;return}try{await U(v.test_id,v.question_id,{text:m.value,points:Number(h.value),is_correct:C.value,position:Number(f.value),question:{type:((t=p.value)==null?void 0:t.type)??N.Text}}),b.value=[],T.push({name:"edit-question",params:{test_id:v.test_id,question_id:v.question_id},query:{sF:0}})}catch(o){b.value=[s("Server Error")+B.value+": "+o.code]}finally{r.value=!1}}}return(t,o)=>(u(),J(oe,{test_id:t.test_id,question_id:t.question_id},{default:K(()=>{var w,E;return[e("div",ie,[e("div",ae,[e("div",ne,i(a(s)("Create Choice")),1),b.value.length?(u(),c("div",le,[e("ul",null,[(u(!0),c(k,null,X(b.value,l=>(u(),c("li",{key:l},i(l),1))),128))])])):_("",!0),e("div",re,i((w=a(p))==null?void 0:w.text),1),e("div",ue,[e("label",ce,i(a(s)("Choice")),1),y(e("input",{type:((E=a(p))==null?void 0:E.type)===a(N).Number?"number":"text",class:x(["form-control",{"is-invalid":n.value.text}]),id:"choice-input-text","onUpdate:modelValue":o[0]||(o[0]=l=>m.value=l),disabled:r.value},null,10,de),[[Y,m.value]]),n.value.text?(u(),c("div",ve,i(n.value.text),1)):_("",!0)]),e("div",pe,[e("label",me,i(a(s)("Points")),1),y(e("input",{type:"number",class:x(["form-control",{"is-invalid":n.value.points}]),id:"choice-input-pts","onUpdate:modelValue":o[1]||(o[1]=l=>h.value=l),disabled:r.value},null,10,he),[[V,h.value]]),n.value.points?(u(),c("div",fe,i(n.value.points),1)):_("",!0)]),e("div",be,[e("div",_e,[y(e("input",{class:"form-check-input",type:"checkbox",id:"choice-input-correctness","onUpdate:modelValue":o[2]||(o[2]=l=>C.value=l)},null,512),[[Z,C.value]]),e("label",ye,i(a(s)("Correct Choice")),1)])]),e("div",Ce,[e("label",ke,i(a(s)("Position")),1),e("span",{class:"label-info","data-bs-content":a(s)("The position of the choice in the question.")},o[4]||(o[4]=[e("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,xe),y(e("input",{type:"number",class:x(["form-control",{"is-invalid":n.value.position}]),id:"choice-input-position","onUpdate:modelValue":o[3]||(o[3]=l=>f.value=l),disabled:r.value},null,10,qe),[[V,f.value]]),n.value.position?(u(),c("div",ge,i(n.value.position),1)):_("",!0)]),e("button",{type:"button",class:"btn btn-primary",onClick:F,disabled:r.value},[r.value?(u(),c(k,{key:1},[M(i(a(s)("Creating"))+" ...",1)],64)):(u(),c(k,{key:0},[M(i(a(s)("Create")),1)],64))],8,Se)])])]}),_:1},8,["test_id","question_id"]))}}),Ae=ee(we,[["__scopeId","data-v-357d36e5"]]);export{Ae as default};
