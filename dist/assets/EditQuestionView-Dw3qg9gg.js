const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ChoiceItem-BiNzQJJm.js","assets/index-CEw6Ur-o.js","assets/index-B9IBSnwR.css","assets/choiceItem-DXlzPwwT.js","assets/testService-F-kZAI4C.js","assets/firestore-O8Pw084e.js","assets/Question-DJVAB3JS.js","assets/ChoiceItemD-CWGYn1pX.js"])))=>i.map(i=>d[i]);
import{d as te,u as oe,G as ie,s as se,b as ne,v as ae,a as le,r as h,x as re,o as de,c as ce,P as ue,e as he,f as z,_ as G,g as _e,z as me,h as F,w,i as n,j as t,p as v,t as o,k as l,F as _,l as V,q as y,A as D,B as H,N as ve,C,m as g}from"./index-CEw6Ur-o.js";import{d as be}from"./vuedraggable.umd-Cx7QRaYl.js";import{u as fe,a as ye,b as ge}from"./testService-F-kZAI4C.js";import{Q as J}from"./Question-DJVAB3JS.js";import{A as ke}from"./AppContainer-CrW-O1Ra.js";import"./firestore-O8Pw084e.js";const xe=te({__name:"EditQuestionView",props:{test_id:{type:String,required:!0},question_id:{type:String,required:!0}},setup(c,{expose:a}){a();const{t:s}=oe(),e=ie(),E=se(),{isDesktop:A,startLoading:k,endLoading:b,showMessage:d}=ne(),{spaceLabel:i}=ae(),{auth:P}=le(),{test:I,loadTest:L}=fe(),{question:u,loadQuestion:N,updateQuestion:O}=ye(),{choices:K,loadChoices:M,updateChoicesPositions:U}=ge(),W=z(()=>G(()=>import("./ChoiceItem-BiNzQJJm.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),X=z(()=>G(()=>import("./ChoiceItemD-CWGYn1pX.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),x=h(""),S=h(J.Text),q=h(0),m=h(e.query.sF!="0"),p=h(!1),f=h(!1),Q=h([]),R=re(()=>{const r={};return p.value&&(x.value===""&&(r.text=s("Question required")),typeof q.value=="string"&&(r.position=s("The position must be a number"))),r}),B=de(P,async()=>{m.value&&k();try{if(await L(c.test_id),!I.value){d("failure",s("Test Not Found."));return}}catch{d("failure",s("Error loading test."))}finally{}try{if(await N(c.test_id,c.question_id),!u.value){d("failure",s("Question Not Found."));return}x.value=u.value.text,S.value=u.value.type,q.value=u.value.position}catch{d("failure",s("Error loading question data."))}finally{m.value&&b()}try{u.value&&await M(c.test_id,u.value)}catch{d("failure",s("Error loading choices."))}}),T=[];ce(()=>{document.querySelectorAll(".app-main .label-info").forEach(ee=>{T.push(new ue(ee,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),he(()=>{T.forEach(r=>r.dispose()),B()});async function Y(){if(!f.value){if(f.value=!0,p.value=!0,Object.keys(R.value).length>0){f.value=!1;return}try{await O(c.test_id,c.question_id,{text:x.value,type:S.value,position:Number(q.value)}),Q.value=[],d("success",s("Question edited with success."))}catch(r){Q.value=[s("Server Error")+i.value+": "+r.code]}finally{f.value=!1}}}function Z(){m.value=!m.value,E.push({query:{sF:m.value?1:0}})}function $(){U(c.test_id,c.question_id).then(()=>{d("success",s("Positions updated with success."))}).catch(r=>{d("failure",s("Sorry! Positions can not be updated."))})}const j={t:s,route:e,router:E,isDesktop:A,startLoading:k,endLoading:b,showMessage:d,spaceLabel:i,auth:P,test:I,loadTest:L,question:u,loadQuestion:N,updateQuestion:O,choices:K,loadChoices:M,updateChoicesPositions:U,ChoiceItem:W,ChoiceItemD:X,text:x,type:S,position:q,showForm:m,submitted:p,submitting:f,serverErrors:Q,errors:R,onAuthEventDispose:B,popOvers:T,editQuestion:Y,toggleShowForm:Z,onDragEnd:$,get draggable(){return be},get QuestionType(){return J},AppContainer:ke};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),qe={class:"app-main"},we={class:"question-form-title mb-4"},Ce=["aria-label"],Ee={key:0,class:"alert alert-danger",role:"alert"},Se={class:"mb-3 test-name"},pe={class:"mb-3"},Qe={for:"question-input-text",class:"form-label"},Te=["disabled","tabindex"],Fe={key:0,class:"invalid-feedback is-invalid"},Ve={class:"mb-3"},De={for:"question-input-type",class:"form-label"},Ae=["disabled","tabindex"],Pe=["value"],Ie=["value"],Le=["value"],Ne=["value"],Oe={key:0,class:"invalid-feedback is-invalid"},Me={class:"mb-3"},Ue={for:"question-input-position",class:"form-label"},Re=["data-bs-content","aria-label","tabindex"],Be=["disabled","tabindex"],je={key:0,class:"invalid-feedback is-invalid"},ze=["disabled","tabindex"],Ge={class:"choice-actions"},He={key:0,class:"choice-info"},Je={key:0,class:"placeholder-wave"},Ke={class:"choice-info-label"},We={key:1,class:"choice-list"},Xe={key:2,class:"choice-list"},Ye={scope:"col"},Ze={scope:"col"},$e={scope:"col"},et={scope:"col"},tt={scope:"col"},ot={scope:"col"},it={key:1};function st(c,a,s,e,E,A){const k=me("RouterLink");return n(),F(e.AppContainer,{test_id:s.test_id},{default:w(()=>{var b,d;return[t("div",qe,[t("div",{class:v(["question-form",{"hide-form":!e.showForm}])},[t("div",we,o(e.t("Edit Question")),1),t("button",{class:"btn toggle-form-btn",onClick:e.toggleShowForm,"aria-label":e.showForm?e.t("hide editing form"):e.t("show editing form")},[t("i",{class:v(["bi",{"bi-chevron-down":!e.showForm,"bi-chevron-up":e.showForm}])},null,2)],8,Ce),e.serverErrors.length?(n(),l("div",Ee,[t("ul",null,[(n(!0),l(_,null,V(e.serverErrors,i=>(n(),l("li",{key:i},o(i),1))),128))])])):y("",!0),t("div",Se,o((b=e.test)==null?void 0:b.name),1),t("div",pe,[t("label",Qe,o(e.t("Question")),1),D(t("input",{type:"text",class:v(["form-control",{"is-invalid":e.errors.text}]),id:"question-input-text","onUpdate:modelValue":a[0]||(a[0]=i=>e.text=i),disabled:e.submitting,tabindex:e.showForm?void 0:-1},null,10,Te),[[H,e.text]]),e.errors.text?(n(),l("div",Fe,o(e.errors.text),1)):y("",!0)]),t("div",Ve,[t("label",De,o(e.t("Question Type")),1),D(t("select",{class:v(["form-select",{"is-invalid":e.errors.type}]),id:"question-input-type","onUpdate:modelValue":a[1]||(a[1]=i=>e.type=i),disabled:e.submitting,tabindex:e.showForm?void 0:-1},[t("option",{value:e.QuestionType.Text},o(e.t("Text")),9,Pe),t("option",{value:e.QuestionType.MultipleChoice},o(e.t("Multiple Choice")),9,Ie),t("option",{value:e.QuestionType.Number},o(e.t("Number")),9,Le),t("option",{value:e.QuestionType.SingleChoice},o(e.t("Single Choice")),9,Ne)],10,Ae),[[ve,e.type]]),e.errors.type?(n(),l("div",Oe,o(e.errors.type),1)):y("",!0)]),t("div",Me,[t("label",Ue,o(e.t("Position")),1),t("button",{class:"label-info","data-bs-content":e.t("The position of the question in the test."),"aria-label":e.t("The position of the question in the test."),tabindex:e.showForm?void 0:-1},a[5]||(a[5]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,Re),D(t("input",{type:"number",class:v(["form-control",{"is-invalid":e.errors.position}]),id:"question-input-position","onUpdate:modelValue":a[2]||(a[2]=i=>e.position=i),disabled:e.submitting,tabindex:e.showForm?void 0:-1},null,10,Be),[[H,e.position]]),e.errors.position?(n(),l("div",je,o(e.errors.position),1)):y("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:e.editQuestion,disabled:e.submitting,tabindex:e.showForm?void 0:-1},[e.submitting?(n(),l(_,{key:1},[C(o(e.t("Editing"))+" ...",1)],64)):(n(),l(_,{key:0},[C(o(e.t("Edit")),1)],64))],8,ze)],2)]),t("div",Ge,[g(k,{to:{name:"create-choice",params:{test_id:s.test_id,question_id:s.question_id}},class:"btn btn-warning"},{default:w(()=>[C(o(e.t("Create New Choice")),1)]),_:1},8,["to"])]),!e.choices||e.choices.length>0?(n(),l("div",He,[e.choices?(n(),l(_,{key:1},[t("span",Ke,o(e.t("Total number of choices"))+o(e.spaceLabel)+":",1),C(" "+o((d=e.choices)==null?void 0:d.length),1)],64)):(n(),l("div",Je,a[6]||(a[6]=[t("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])):y("",!0),e.isDesktop?(n(),l("div",Xe,[t("table",{class:v(["table",{loading:!e.choices}])},[t("thead",null,[t("tr",null,[a[7]||(a[7]=t("th",{scope:"col"},null,-1)),t("th",Ye,o(e.t("Choice")),1),t("th",Ze,o(e.t("Points")),1),t("th",$e,o(e.t("Is Correct?")),1),t("th",et,o(e.t("Position")),1),t("th",tt,o(e.t("Last updated at")),1),t("th",ot,o(e.t("Actions")),1)])]),e.choices?(n(),F(e.draggable,{key:0,modelValue:e.choices,"onUpdate:modelValue":a[4]||(a[4]=i=>e.choices=i),"item-key":"id",tag:"tbody",handle:".choice-item-sort-handler",onEnd:e.onDragEnd},{item:w(({element:i})=>[g(e.ChoiceItemD,{test_id:s.test_id,question_id:s.question_id,choice:i},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(n(),l("tbody",it,[(n(),l(_,null,V(5,i=>g(e.ChoiceItemD,{key:"choice-placeholder-"+i})),64))]))],2)])):(n(),l(_,{key:1},[e.choices?(n(),F(e.draggable,{key:0,modelValue:e.choices,"onUpdate:modelValue":a[3]||(a[3]=i=>e.choices=i),"item-key":"id",tag:"div","component-data":{class:"choice-list"},handle:".choice-item-sort-handler",onEnd:e.onDragEnd},{item:w(({element:i})=>[g(e.ChoiceItem,{test_id:s.test_id,question_id:s.question_id,choice:i},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(n(),l("div",We,[(n(),l(_,null,V([0,1,2],i=>g(e.ChoiceItem,{key:"choice-placeholder-"+i})),64))]))],64))]}),_:1},8,["test_id"])}const ut=_e(xe,[["render",st],["__scopeId","data-v-2d7f7ac0"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/EditQuestionView.vue"]]);export{ut as default};
