import{d as q,q as U,g as I,B as x,r as B,c as E,i as N,M as H,j as F,_ as O,v as z,o as i,a as l,b as s,t as v,n as A,e as T,p as k,w,f as Y,u as G,h as J,k as K,R as Q,l as C,z as R,F as L,m as V}from"./index-DgVFOuIu.js";import{u as j}from"./testService-B9g0yUeR.js";import{A as W}from"./AppContainer-B7WmBWY1.js";import"./firestore-CKAN35Ge.js";import"./Question-DJVAB3JS.js";import"./Breadcrumb-0WoaLxXW.js";const X=q({__name:"TestItem",props:{test:{type:Object,required:!1}},setup(r,{expose:e}){e();const o=U(),{showMessage:t,startLoading:m,endLoading:b}=I(),{deleteTest:a}=j(),c=x("test-description"),_=x("confirm-deletion-modal"),p=B(!1),f=new Date;let n=null;const g=E(()=>p.value?r.test.description.replace(/\n/g,"<br />"):r.test.description.replace(/\n/g,"")),h=E(()=>{const d=r.test.updated_at.toDate();return new Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:f.getFullYear()===d.getFullYear()?void 0:"numeric",hour:"numeric",minute:"numeric"}).format(d)});N(()=>{c.value&&c.value.addEventListener("click",y),_.value&&(n=new H(_.value))}),F(()=>{c.value&&c.value.removeEventListener("click",y),n&&n.dispose()});function y(){p.value=!0}function u(){n&&n.show()}async function D(){var d;if(n&&n.hide(),(d=r.test)!=null&&d.id)try{m(),await a(r.test.id),t("success","Test deleted with success.")}catch{t("failure","Test can not be deleted.")}finally{b()}}function P(){const d=o.resolve({name:"test-portal",params:{test_id:r.test.id}}),S=location.origin+d.fullPath;navigator.clipboard.writeText(S).then(()=>{t("success","Test link copied!")}).catch(()=>{t("failure","Sorry, Test link couldn't be copied!")})}const M={router:o,showMessage:t,startLoading:m,endLoading:b,deleteTest:a,testDescriptionEl:c,testConfirmDeletionModalEl:_,showMore:p,currentDate:f,get testConfirmDeletionModal(){return n},set testConfirmDeletionModal(d){n=d},description:g,updatedAt:h,showMoreDescription:y,confirmTestdeletion:u,deleteDTest:D,copyTestLink:P};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),Z={key:0,class:"test-item-content"},$={class:"test-item-title"},tt={class:"test-item-info"},et=["innerHTML"],st={class:"test-property"},ot={class:"test-property"},nt={key:0,class:"test-property"},it={class:"test-last-update"},at={class:"test-item-actions"},lt={key:1,class:"test-item-content"},rt={key:2,class:"modal",tabindex:"-1",ref:"confirm-deletion-modal"},dt={class:"modal-dialog modal-dialog-centered"},ct={class:"modal-content"},ut={class:"modal-body"};function mt(r,e,o,t,m,b){const a=z("RouterLink");return i(),l("div",{class:A(["test-item-container",{"placeholder-wave":!o.test}])},[o.test?(i(),l("div",Z,[s("div",$,v(o.test.name),1),e[4]||(e[4]=s("hr",{class:"test-item-divider"},null,-1)),s("div",tt,[s("div",{class:A(["test-description",{"full-text":t.showMore}]),ref:"test-description",innerHTML:t.description},null,10,et),s("div",st,"Max Score: "+v(o.test.max_points),1),s("div",ot,"Time Limit: "+v(o.test.time_limit),1),o.test.questionCount?(i(),l("div",nt,"Total number of questions: "+v(o.test.questionCount),1)):T("",!0),s("div",it,"Last updated at: "+v(t.updatedAt),1)]),e[5]||(e[5]=s("hr",{class:"test-item-divider"},null,-1)),s("div",at,[k(a,{to:{name:"preview-test",params:{test_id:o.test.id}},class:"btn btn-primary"},{default:w(()=>e[0]||(e[0]=[s("i",{class:"bi bi-eye-fill"},null,-1)])),_:1},8,["to"]),k(a,{to:{name:"edit-test",params:{test_id:o.test.id}},class:"btn btn-success"},{default:w(()=>e[1]||(e[1]=[s("i",{class:"bi bi-pencil-fill"},null,-1)])),_:1},8,["to"]),s("button",{type:"button",class:"btn btn-danger",onClick:t.confirmTestdeletion},e[2]||(e[2]=[s("i",{class:"bi bi-trash3-fill"},null,-1)])),s("button",{type:"button",class:"btn btn-warning",onClick:t.copyTestLink},e[3]||(e[3]=[s("i",{class:"bi bi-copy"},null,-1)]))])])):(i(),l("div",lt,e[6]||(e[6]=[Y('<div class="test-item-title placeholder col-6 offset-3 placeholder-lg bg-secondary"></div><hr class="test-item-divider"><div class="test-item-info"><div class="placeholder col-12 bg-secondary" style="min-height:4em;"></div><div class="placeholder col-8 offset-4 placeholder-sm bg-secondary"></div></div><hr class="test-item-divider"><div class="test-item-actions placeholder col-9 offset-3 placeholder-lg bg-secondary"></div>',5)]))),o.test?(i(),l("div",rt,[s("div",dt,[s("div",ct,[e[8]||(e[8]=s("div",{class:"modal-header"},[s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),s("div",ut,[s("p",null,'Are you sure you want to delete this test: "'+v(o.test.name)+'"?',1)]),s("div",{class:"modal-footer"},[e[7]||(e[7]=s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),s("button",{type:"button",class:"btn btn-danger",onClick:t.deleteDTest},"Delete")])])])],512)):T("",!0)],2)}const ft=O(X,[["render",mt],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/components/items/TestItem.vue"]]),vt=q({__name:"TestsView",setup(r,{expose:e}){e();const{showMessage:o}=I(),{auth:t,user:m}=G(),{testCount:b,tests:a,loadTestCount:c,loadTests:_,loadMoreTests:p}=j(),f=B(!1);let n=null;const g=J(t,async u=>{try{if(u===null)return;await Promise.all([c(u.uid),_(u.uid)]),n||(n=document.querySelector(".tests-loader"))}catch{o("failure","Error loading tests.")}});N(()=>{document.addEventListener("scroll",h),n||(n=document.querySelector(".tests-loader"))}),F(()=>{g(),document.removeEventListener("scroll",h)});async function h(){if(n&&!f.value&&n.getBoundingClientRect().top<window.innerHeight&&m.value){f.value=!0;try{await p(),await K(),n=document.querySelector(".tests-loader")}catch{o("failure","Error loading more tests.")}finally{f.value=!1}}}const y={showMessage:o,auth:t,user:m,testCount:b,tests:a,loadTestCount:c,loadTests:_,loadMoreTests:p,loadingTests:f,get testsLoaderEl(){return n},set testsLoaderEl(u){n=u},onAuthEventDispose:g,checkLoaderVisiblity:h,get RouterLink(){return Q},TestItem:ft,AppContainer:W};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),bt={class:"app-main"},_t={class:"test-actions"},pt={key:0,class:"test-info"},yt={key:1,class:"placeholder-wave"},ht={class:"test-list"};function gt(r,e,o,t,m,b){return i(),C(t.AppContainer,null,{default:w(()=>[s("div",bt,[s("div",_t,[k(t.RouterLink,{to:{name:"create-test"},class:"btn btn-warning create-test"},{default:w(()=>e[0]||(e[0]=[R("Create New Test")])),_:1})]),t.testCount!==0?(i(),l("div",pt,[t.testCount?(i(),l(L,{key:0},[e[1]||(e[1]=s("span",{class:"test-info-label"},"Total number of tests:",-1)),R(" "+v(t.testCount),1)],64)):(i(),l("div",yt,e[2]||(e[2]=[s("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])):T("",!0),s("div",ht,[t.tests?(i(!0),l(L,{key:0},V(t.tests,a=>(i(),C(t.TestItem,{test:a,key:a.id},null,8,["test"]))),128)):(i(),l(L,{key:1},V([0,1,2],a=>k(t.TestItem,{key:"test-placeholder-"+a})),64)),t.testCount&&t.tests&&t.tests.length<t.testCount?(i(),C(t.TestItem,{key:"test-placeholder-loading",class:"tests-loader"})):T("",!0)])])]),_:1})}const Mt=O(vt,[["render",gt],["__scopeId","data-v-8faed77a"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/TestsView.vue"]]);export{Mt as default};
