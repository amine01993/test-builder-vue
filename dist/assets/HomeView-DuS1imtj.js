import{c as C,d as b,_ as w,o as n,a as i,b as t,t as l,e as U,f as N,n as g,F as v,u as x,g as O,r as V,h as j,i as q,j as M,k as B,l as p,w as H,m as k,p as E}from"./index-CGS4B7OT.js";import{u as P}from"./testService-DeBIOd3R.js";import{u as Y}from"./userTestService-CXkSjIBF.js";import{A as Q}from"./AppContainer-BbQHt-u2.js";import"./firestore-B39V3hTY.js";import"./Question-DJVAB3JS.js";function L(u){const r=new Date,s=C(()=>{const o=u.started_at.toDate();return new Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:r.getFullYear()===o.getFullYear()?void 0:"numeric",hour:"numeric",minute:"numeric"}).format(o)}),e=C(()=>{var c;const o=u.started_at.toDate(),a=(c=u.ended_in)==null?void 0:c.toDate();if(a){let _=Math.floor((a-o)/1e3);const f=Math.floor(_/60/60);_=_-f*60*60;const T=Math.floor(_/60);_=_-T*60;const h=_;let d=[];return f&&d.push(f+"h"),T&&d.push(T+"min"),h&&d.push(h+"s"),d.join(" ")}return""}),m=C(()=>{const o=u.updated_at.toDate();return new Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:r.getFullYear()===o.getFullYear()?void 0:"numeric",hour:"numeric",minute:"numeric"}).format(o)});return{startedAt:s,lastedFor:e,updatedAt:m}}const z=b({__name:"UserTestItem",props:{userTest:{type:Object,required:!1}},setup(u,{expose:r}){r();const{startedAt:s,lastedFor:e,updatedAt:m}=L(u.userTest),o={startedAt:s,lastedFor:e,updatedAt:m};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),R={key:0,class:"user-test-item-content"},G={class:"user-test-item-title"},J={class:"user-test-item-info"},K={class:"user-test-property"},W={class:"user-test-property"},X={class:"user-test-property"},Z={class:"user-test-property"},$={key:0,class:"user-test-property"},ee={class:"user-test-property"},te={class:"user-test-last-update"},se={key:1,class:"test-item-content"};function re(u,r,s,e,m,o){var a,c;return n(),i("div",{class:g(["user-test-item-container",{"placeholder-wave":!s.userTest}])},[s.userTest?(n(),i("div",R,[t("div",G,l(s.userTest.test.name),1),r[0]||(r[0]=t("hr",{class:"user-test-item-divider"},null,-1)),t("div",J,[t("div",K,"Full Name: "+l(s.userTest.user.displayName),1),t("div",W,"Email: "+l(s.userTest.user.email),1),t("div",X,"Started At: "+l(e.startedAt),1),t("div",Z,"Lasted For: "+l(e.lastedFor),1),s.userTest.result?(n(),i("div",$,"Score: "+l((a=s.userTest.result)==null?void 0:a.score),1)):U("",!0),t("div",ee,"Answered Questions: "+l(((c=s.userTest.report)==null?void 0:c.length)??0)+" out of "+l(s.userTest.test.questionCount),1),t("div",te,"Last updated at: "+l(e.updatedAt),1)])])):(n(),i("div",se,r[1]||(r[1]=[N('<div class="test-item-title placeholder col-6 offset-3 placeholder-lg bg-secondary"></div><hr class="test-item-divider"><div class="test-item-info"><div class="placeholder col-12 bg-secondary" style="min-height:6em;"></div><div class="placeholder col-8 offset-4 placeholder-sm bg-secondary"></div></div>',3)])))],2)}const oe=w(z,[["render",re],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/components/items/UserTestItem.vue"]]),ae=b({__name:"UserTestItemD",props:{userTest:{type:Object,required:!1}},setup(u,{expose:r}){r();const{startedAt:s,lastedFor:e,updatedAt:m}=L(u.userTest),o={startedAt:s,lastedFor:e,updatedAt:m};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}}),ne={class:"test-last-update"},le={key:1,colspan:"8",class:"placeholder bg-secondary"};function ie(u,r,s,e,m,o){var a,c;return n(),i("tr",{class:g(["user-test-item-container",{"placeholder-wave":!s.userTest}])},[s.userTest?(n(),i(v,{key:0},[t("th",null,l(s.userTest.test.name),1),t("td",null,l(s.userTest.user.displayName),1),t("td",null,l(s.userTest.user.email),1),t("td",null,l(e.startedAt),1),t("td",null,l(e.lastedFor),1),t("td",null,l((a=s.userTest.result)==null?void 0:a.score),1),t("td",null,l(((c=s.userTest.report)==null?void 0:c.length)??0)+" out of "+l(s.userTest.test.questionCount),1),t("td",ne,l(e.updatedAt),1)],64)):(n(),i("td",le))],2)}const de=w(ae,[["render",ie],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/components/items/UserTestItemD.vue"]]),D="user-tests-loader",ue=b({__name:"HomeView",setup(u,{expose:r}){r();const{auth:s,user:e}=x(),{isDesktop:m,showMessage:o}=O(),{testCount:a,loadTestCount:c}=P(),{userTestCount:A,userTests:_,loadUserTests:f,loadMoreUserTests:T}=Y(),h=V(!1);let d=null;const I=j(s,async y=>{try{await Promise.all([c(y.uid),f(y.uid)]),d||(d=document.querySelector(`.${D}`))}catch{o("failure","Error loading test sessions.")}});q(()=>{document.addEventListener("scroll",S),d||(d=document.querySelector(`.${D}`))}),M(()=>{I(),document.removeEventListener("scroll",S)});async function S(){if(d&&!h.value&&d.getBoundingClientRect().top<window.innerHeight&&e.value){h.value=!0;try{await T(),await B(),d=document.querySelector(`.${D}`)}catch{o("failure","Error loading more test sessions.")}finally{h.value=!1}}}const F={auth:s,user:e,isDesktop:m,showMessage:o,testCount:a,loadTestCount:c,userTestCount:A,userTests:_,loadUserTests:f,loadMoreUserTests:T,loadingUserTests:h,get userTestsLoaderEl(){return d},set userTestsLoaderEl(y){d=y},loaderClassName:D,onAuthEventDispose:I,checkLoaderVisiblity:S,AppContainer:Q,UserTestItem:oe,UserTestItemD:de};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),ce={class:"app-main"},me={class:"test-stats"},_e={class:"test-stat"},he={class:"stat-content"},fe={class:"test-stat"},Te={key:0,class:"stat-content"},ve={key:1,class:"placeholder-wave"},ye={class:"test-report-list"};function pe(u,r,s,e,m,o){return n(),p(e.AppContainer,null,{default:H(()=>[t("div",ce,[t("div",me,[t("div",_e,[r[0]||(r[0]=t("div",{class:"stat-title"},"Tests",-1)),t("div",he,l(e.testCount),1)]),t("div",fe,[r[2]||(r[2]=t("div",{class:"stat-title"},"Test Sessions",-1)),e.userTestCount!==void 0?(n(),i("div",Te,l(e.userTestCount),1)):(n(),i("div",ve,r[1]||(r[1]=[t("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])]),t("div",ye,[e.isDesktop?(n(),i("table",{key:1,class:g(["table",{loading:!e.userTests}])},[r[3]||(r[3]=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"Test"),t("th",{scope:"col"},"Full Name"),t("th",{scope:"col"},"Email"),t("th",{scope:"col"},"Started At"),t("th",{scope:"col"},"Lasted For"),t("th",{scope:"col"},"Score"),t("th",{scope:"col"},"Answered Questions"),t("th",{scope:"col"},"Last updated at")])],-1)),t("tbody",null,[e.userTests?(n(!0),i(v,{key:0},k(e.userTests,a=>(n(),p(e.UserTestItemD,{userTest:a,key:a.id},null,8,["userTest"]))),128)):(n(),i(v,{key:1},k(5,a=>E(e.UserTestItemD,{key:"user-test-placeholder-"+a})),64)),e.userTestCount&&e.userTests&&e.userTests.length<e.userTestCount?(n(),p(e.UserTestItemD,{key:"user-test-placeholder-loading",class:g(e.loaderClassName)})):U("",!0)])],2)):(n(),i(v,{key:0},[e.userTests?(n(!0),i(v,{key:0},k(e.userTests,a=>(n(),p(e.UserTestItem,{userTest:a,key:a.id},null,8,["userTest"]))),128)):(n(),i(v,{key:1},k(2,a=>E(e.UserTestItem,{key:"user-test-placeholder-"+a})),64)),e.userTestCount&&e.userTests&&e.userTests.length<e.userTestCount?(n(),p(e.UserTestItem,{key:"user-test-placeholder-loading",class:g(e.loaderClassName)})):U("",!0)],64))])])]),_:1})}const we=w(ue,[["render",pe],["__scopeId","data-v-b4e148ca"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/HomeView.vue"]]);export{we as default};
