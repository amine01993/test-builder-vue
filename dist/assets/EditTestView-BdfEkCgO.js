const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/QuestionItem-CSbcMaZR.js","assets/index-CEw6Ur-o.js","assets/index-B9IBSnwR.css","assets/questionItem-BfzVqpXG.js","assets/testService-F-kZAI4C.js","assets/firestore-O8Pw084e.js","assets/Question-DJVAB3JS.js","assets/utils-BFrGjP34.js","assets/QuestionItemD-QkfPrV2z.js"])))=>i.map(i=>d[i]);
import{d as Z,u as $,G as ee,s as te,b as ie,v as oe,a as se,r as c,x as ne,o as ae,c as re,P as le,e as de,f as j,_ as z,g as ce,z as me,h as F,w as E,i as s,j as t,p as _,t as o,k as a,F as m,l as S,q as g,A as D,B as C,C as p,m as y}from"./index-CEw6Ur-o.js";import{d as ue}from"./vuedraggable.umd-Cx7QRaYl.js";import{u as _e,a as be}from"./testService-F-kZAI4C.js";import{A as he}from"./AppContainer-CrW-O1Ra.js";import"./firestore-O8Pw084e.js";import"./Question-DJVAB3JS.js";const ve=Z({__name:"EditTestView",props:{test_id:{type:String,required:!0}},setup(b,{expose:n}){n();const{t:r}=$(),e=ee(),q=te(),{isDesktop:A,startLoading:k,endLoading:h,showMessage:i}=ie(),{spaceLabel:P}=oe(),{auth:Q}=se(),{test:d,loadTest:I,updateTest:N}=_e(),{questions:G,loadQuestions:O,updateQuestionsPositions:U}=be(),H=j(()=>z(()=>import("./QuestionItem-CSbcMaZR.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),J=j(()=>z(()=>import("./QuestionItemD-QkfPrV2z.js"),__vite__mapDeps([8,1,2,3,4,5,6,7]))),w=c(""),L=c(""),v=c(0),u=c(e.query.sF!="0"),T=c(!1),f=c(!1),x=c([]),R=ne(()=>{const l={};return T.value&&(w.value===""&&(l.name=r("Name required")),typeof v.value=="string"?l.timeLimit=r("The time limit must be a number"):v.value<0&&(l.timeLimit=r("The time limit can't be a negatif number"))),l}),B=ae(Q,async()=>{u.value&&k();try{if(await I(b.test_id),!d.value){i("failure",r("Test Not Found."));return}w.value=d.value.name,L.value=d.value.description,v.value=d.value.time_limit}catch{i("failure",r("Error loading test data."))}finally{u.value&&h()}try{d.value&&await O(d.value)}catch{i("failure",r("Error loading questions."))}}),V=[];re(()=>{document.querySelectorAll(".app-main .label-info").forEach(Y=>{V.push(new le(Y,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),de(()=>{V.forEach(l=>l.dispose()),B()});async function K(){if(!f.value){if(f.value=!0,T.value=!0,Object.keys(R.value).length>0){f.value=!1;return}try{await N(b.test_id,{name:w.value,description:L.value,time_limit:Number(v.value)}),x.value=[],q.push({name:"tests"})}catch(l){x.value=[r("Server Error")+P.value+": "+l.code]}finally{f.value=!1}}}function W(){u.value=!u.value,q.push({query:{sF:u.value?1:0}})}function X(){b.test_id&&U(b.test_id).then(()=>{i("success",r("Positions updated with success."))}).catch(l=>{i("failure",r("Sorry! Positions can not be updated."))})}const M={t:r,route:e,router:q,isDesktop:A,startLoading:k,endLoading:h,showMessage:i,spaceLabel:P,auth:Q,test:d,loadTest:I,updateTest:N,questions:G,loadQuestions:O,updateQuestionsPositions:U,QuestionItem:H,QuestionItemD:J,name:w,description:L,timeLimit:v,showForm:u,submitted:T,submitting:f,serverErrors:x,errors:R,onAuthEventDispose:B,popOvers:V,editTest:K,toggleShowForm:W,onDragEnd:X,get draggable(){return ue},AppContainer:he};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),fe={class:"app-main"},ge={class:"test-form-title mb-4"},ye=["aria-label"],qe={key:0,class:"alert alert-danger",role:"alert"},ke={class:"mb-3"},we={for:"test-input-name",class:"form-label"},Ee=["disabled","tabindex"],pe={key:0,class:"invalid-feedback is-invalid"},Le={class:"mb-3"},Te={for:"test-input-description",class:"form-label"},xe=["disabled","tabindex"],Ve={key:0,class:"invalid-feedback is-invalid"},Fe={class:"mb-3"},Se={for:"test-input-timelimit",class:"form-label"},De=["data-bs-content","aria-label","tabindex"],Ce=["disabled","tabindex"],Ae={key:0,class:"invalid-feedback is-invalid"},Pe=["disabled","tabindex"],Qe={class:"question-actions"},Ie={key:0,class:"question-info"},Ne={key:0,class:"placeholder-wave"},Oe={class:"question-info-label"},Ue={key:1,class:"question-list"},Re={key:2,class:"question-list"},Be={scope:"col"},Me={scope:"col"},je={scope:"col"},ze={scope:"col"},Ge={scope:"col"},He={scope:"col"},Je={scope:"col"},Ke={key:1};function We(b,n,r,e,q,A){const k=me("RouterLink");return s(),F(e.AppContainer,null,{default:E(()=>{var h;return[t("div",fe,[t("div",{class:_(["test-form",{"hide-form":!e.showForm}])},[t("div",ge,o(e.t("Edit Test")),1),t("button",{class:"btn toggle-form-btn",onClick:e.toggleShowForm,"aria-label":e.showForm?e.t("hide editing form"):e.t("show editing form")},[t("i",{class:_(["bi",{"bi-chevron-down":!e.showForm,"bi-chevron-up":e.showForm}])},null,2)],8,ye),e.serverErrors.length?(s(),a("div",qe,[t("ul",null,[(s(!0),a(m,null,S(e.serverErrors,i=>(s(),a("li",{key:i},o(i),1))),128))])])):g("",!0),t("div",ke,[t("label",we,o(e.t("Name")),1),D(t("input",{type:"text",class:_(["form-control",{"is-invalid":e.errors.name}]),id:"test-input-name","onUpdate:modelValue":n[0]||(n[0]=i=>e.name=i),disabled:e.submitting,tabindex:e.showForm?void 0:-1},null,10,Ee),[[C,e.name]]),e.errors.name?(s(),a("div",pe,o(e.errors.name),1)):g("",!0)]),t("div",Le,[t("label",Te,o(e.t("Description")),1),D(t("textarea",{class:_(["form-control",{"is-invalid":e.errors.description}]),id:"test-input-description","onUpdate:modelValue":n[1]||(n[1]=i=>e.description=i),rows:"3",disabled:e.submitting,tabindex:e.showForm?void 0:-1},null,10,xe),[[C,e.description]]),e.errors.description?(s(),a("div",Ve,o(e.errors.description),1)):g("",!0)]),t("div",Fe,[t("label",Se,o(e.t("Time Limit")),1),t("button",{class:"label-info","data-bs-content":e.t("The test Time Limit is in seconds.<br>0 = no Time Limit"),"aria-label":e.t("the test time limit input is in seconds. the value of 0 means no time limit"),tabindex:e.showForm?void 0:-1},n[5]||(n[5]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,De),D(t("input",{type:"number",class:_(["form-control",{"is-invalid":e.errors.timeLimit}]),id:"test-input-timelimit","onUpdate:modelValue":n[2]||(n[2]=i=>e.timeLimit=i),disabled:e.submitting,tabindex:e.showForm?void 0:-1},null,10,Ce),[[C,e.timeLimit]]),e.errors.timeLimit?(s(),a("div",Ae,o(e.errors.timeLimit),1)):g("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:e.editTest,disabled:e.submitting,tabindex:e.showForm?void 0:-1},[e.submitting?(s(),a(m,{key:1},[p(o(e.t("Editing"))+" ...",1)],64)):(s(),a(m,{key:0},[p(o(e.t("Edit")),1)],64))],8,Pe)],2)]),t("div",Qe,[y(k,{to:{name:"create-question",params:{test_id:r.test_id}},class:"btn btn-warning create-question"},{default:E(()=>[p(o(e.t("Create New Question")),1)]),_:1},8,["to"])]),!e.questions||e.questions.length>0?(s(),a("div",Ie,[e.questions?(s(),a(m,{key:1},[t("span",Oe,o(e.t("Total number of questions"))+o(e.spaceLabel)+":",1),p(" "+o((h=e.questions)==null?void 0:h.length),1)],64)):(s(),a("div",Ne,n[6]||(n[6]=[t("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])):g("",!0),e.isDesktop?(s(),a("div",Re,[t("table",{class:_(["table",{loading:!e.questions}])},[t("thead",null,[t("tr",null,[n[7]||(n[7]=t("th",{scope:"col"},null,-1)),t("th",Be,o(e.t("Question")),1),t("th",Me,o(e.t("Max Points")),1),t("th",je,o(e.t("Type")),1),t("th",ze,o(e.t("Position")),1),t("th",Ge,o(e.t("Nbr of Choices")),1),t("th",He,o(e.t("Last updated at")),1),t("th",Je,o(e.t("Actions")),1)])]),e.questions?(s(),F(e.draggable,{key:0,modelValue:e.questions,"onUpdate:modelValue":n[4]||(n[4]=i=>e.questions=i),"item-key":"id",tag:"tbody",handle:".question-item-sort-handler",onEnd:e.onDragEnd},{item:E(({element:i})=>[y(e.QuestionItemD,{test_id:r.test_id,question:i},null,8,["test_id","question"])]),_:1},8,["modelValue"])):(s(),a("tbody",Ke,[(s(),a(m,null,S(5,i=>y(e.QuestionItemD,{key:"question-placeholder-"+i})),64))]))],2)])):(s(),a(m,{key:1},[e.questions?(s(),F(e.draggable,{key:0,modelValue:e.questions,"onUpdate:modelValue":n[3]||(n[3]=i=>e.questions=i),"item-key":"id",tag:"div","component-data":{class:"question-list"},handle:".question-item-sort-handler",onEnd:e.onDragEnd},{item:E(({element:i})=>[y(e.QuestionItem,{test_id:r.test_id,question:i},null,8,["test_id","question"])]),_:1},8,["modelValue"])):(s(),a("div",Ue,[(s(),a(m,null,S([0,1,2],i=>y(e.QuestionItem,{key:"question-placeholder-"+i})),64))]))],64))]}),_:1})}const it=ce(ve,[["render",We],["__scopeId","data-v-a0982f31"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/EditTestView.vue"]]);export{it as default};
