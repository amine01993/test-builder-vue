import{d as F,q as B,g as j,u as L,r,c as z,h as I,i as R,P as G,j as H,_ as J,l as K,w as W,o as a,b as i,a as l,F as k,m as X,t as v,e as h,x as y,ab as Y,n as E,y as M,ac as Z,z as O}from"./index-CGS4B7OT.js";import{a as $,b as ee}from"./testService-DeBIOd3R.js";import{Q as P}from"./Question-DJVAB3JS.js";import{A as te}from"./AppContainer-BbQHt-u2.js";import"./firestore-B39V3hTY.js";const ie=F({__name:"EditChoiceView",props:{test_id:{type:String,required:!0},question_id:{type:String,required:!0},choice_id:{type:String,required:!0}},setup(n,{expose:t}){t();const u=B(),{startLoading:e,endLoading:_,showMessage:d}=j(),{auth:s}=L(),{getQuestion:S}=$(),{getChoice:w,updateChoice:T}=ee(),V=r(""),g=r(P.Text),b=r(""),f=r(0),q=r(!1),p=r(0),x=r(!1),m=r(!1),N=r([]),A=z(()=>{const o={};return x.value&&(b.value===""&&(o.text="Choice required"),typeof f.value=="string"&&(o.points="Points must be a number"),typeof p.value=="string"&&(o.position="The position must be a number")),o}),Q=I(s,async()=>{e();try{const o=await S(n.test_id,n.question_id);if(!o){d("failure","Question Not Found.");return}V.value=o.text,g.value=o.type;const c=await w(n.test_id,n.question_id,n.choice_id);if(!c){d("failure","Choice Not Found.");return}b.value=c.text,q.value=c.is_correct,f.value=c.points,p.value=c.position}catch{d("failure","Error loading data.")}finally{_()}}),C=[];R(()=>{document.querySelectorAll(".app-main .label-info").forEach(c=>{C.push(new G(c,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),H(()=>{C.forEach(o=>o.dispose()),Q()});async function U(){if(!m.value){if(m.value=!0,x.value=!0,Object.keys(A.value).length>0){m.value=!1;return}try{await T(n.test_id,n.question_id,n.choice_id,{text:b.value,is_correct:q.value,points:Number(f.value),position:Number(p.value),question:{type:g.value}}),d("success","Choice edited with success."),u.push({name:"edit-question",params:{test_id:n.test_id,question_id:n.question_id},query:{sF:0}})}catch(o){N.value=["Server Error: "+o.code]}finally{m.value=!1}}}const D={router:u,startLoading:e,endLoading:_,showMessage:d,auth:s,getQuestion:S,getChoice:w,updateChoice:T,questionText:V,questionType:g,text:b,points:f,correctness:q,position:p,submitted:x,submitting:m,serverErrors:N,errors:A,onAuthEventDispose:Q,popOvers:C,editChoice:U,get QuestionType(){return P},AppContainer:te};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),oe={class:"app-main"},se={class:"choice-form"},ne={key:0,class:"alert alert-danger",role:"alert"},re={class:"mb-3 question-text"},ae={class:"mb-3"},le=["type","disabled"],ce={key:0,class:"invalid-feedback is-invalid"},de={class:"mb-3"},ue=["disabled"],me={key:0,class:"invalid-feedback is-invalid"},ve={class:"mb-3"},be={class:"form-check"},fe={class:"mb-3"},pe=["disabled"],he={key:0,class:"invalid-feedback is-invalid"},ye=["disabled"];function _e(n,t,u,e,_,d){return a(),K(e.AppContainer,{test_id:u.test_id,question_id:u.question_id},{default:W(()=>[i("div",oe,[i("div",se,[t[9]||(t[9]=i("div",{class:"choice-form-title mb-4"},"Edit Choice",-1)),e.serverErrors.length?(a(),l("div",ne,[i("ul",null,[(a(!0),l(k,null,X(e.serverErrors,s=>(a(),l("li",{key:s},v(s),1))),128))])])):h("",!0),i("div",re,v(e.questionText),1),i("div",ae,[t[4]||(t[4]=i("label",{for:"choice-input-text",class:"form-label"},"Choice",-1)),y(i("input",{type:e.questionType===e.QuestionType.Number?"number":"text",class:E(["form-control",{"is-invalid":e.errors.text}]),id:"choice-input-text","onUpdate:modelValue":t[0]||(t[0]=s=>e.text=s),disabled:e.submitting},null,10,le),[[Y,e.text]]),e.errors.text?(a(),l("div",ce,v(e.errors.text),1)):h("",!0)]),i("div",de,[t[5]||(t[5]=i("label",{for:"choice-input-pts",class:"form-label"},"Points",-1)),y(i("input",{type:"number",class:E(["form-control",{"is-invalid":e.errors.points}]),id:"choice-input-pts","onUpdate:modelValue":t[1]||(t[1]=s=>e.points=s),disabled:e.submitting},null,10,ue),[[M,e.points]]),e.errors.points?(a(),l("div",me,v(e.errors.points),1)):h("",!0)]),i("div",ve,[i("div",be,[y(i("input",{class:"form-check-input",type:"checkbox",id:"choice-input-correctness","onUpdate:modelValue":t[2]||(t[2]=s=>e.correctness=s)},null,512),[[Z,e.correctness]]),t[6]||(t[6]=i("label",{class:"form-check-label",for:"choice-input-correctness"}," Correct Choice ",-1))])]),i("div",fe,[t[7]||(t[7]=i("label",{for:"question-input-position",class:"form-label"},"Position",-1)),t[8]||(t[8]=i("span",{class:"label-info","data-bs-content":"The position of the choice in the question."},[i("i",{class:"bi bi-question-circle-fill"})],-1)),y(i("input",{type:"number",class:E(["form-control",{"is-invalid":e.errors.position}]),id:"question-input-position","onUpdate:modelValue":t[3]||(t[3]=s=>e.position=s),disabled:e.submitting},null,10,pe),[[M,e.position]]),e.errors.position?(a(),l("div",he,v(e.errors.position),1)):h("",!0)]),i("button",{type:"button",class:"btn btn-primary",onClick:e.editChoice,disabled:e.submitting},[e.submitting?(a(),l(k,{key:1},[O("Editing ...")],64)):(a(),l(k,{key:0},[O("Edit")],64))],8,ye)])])]),_:1},8,["test_id","question_id"])}const Ee=J(ie,[["render",_e],["__scopeId","data-v-f5467906"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/EditChoiceView.vue"]]);export{Ee as default};
