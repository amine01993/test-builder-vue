import{d as O,u as U,b as D,a as L,v as P,r as c,x as j,o as z,c as I,P as R,e as $,f as G,w as H,y as J,g as u,h as e,t as o,i as s,j as d,F as y,k as K,p as b,A as x,B as Q,m as g,S as W,C as w,s as X}from"./index-hcXieGcP.js";import{u as Y,a as Z}from"./testService-NaHZ2zF2.js";import{Q as v}from"./Question-DJVAB3JS.js";import{_ as ee}from"./AppContainer.vue_vue_type_script_setup_true_lang-Do8g_JjI.js";import"./firestore-t582GyIa.js";const te={class:"app-main"},se={class:"question-form"},oe={class:"question-form-title mb-4"},ae={key:0,class:"alert alert-danger",role:"alert"},ie={class:"mb-3 test-name"},ne={class:"mb-3"},le={for:"question-input-text",class:"form-label"},ue=["disabled"],re={key:0,class:"invalid-feedback is-invalid"},de={class:"mb-3"},ce={for:"question-input-type",class:"form-label"},ve=["disabled"],pe=["value"],_e=["value"],me=["value"],fe=["value"],be={key:0,class:"invalid-feedback is-invalid"},he={class:"mb-3"},ye={for:"question-input-position",class:"form-label"},xe=["data-bs-content"],ge=["disabled"],ke={key:0,class:"invalid-feedback is-invalid"},Ce=["disabled"],Se=O({__name:"CreateQuestionView",props:{test_id:{}},setup(k){const E=J(),{t}=U(),{showMessage:C}=D(),{auth:V}=L(),{spaceLabel:M}=P(),{test:p,loadTest:N}=Y(),{addQuestion:A}=Z(),_=c(""),h=c(v.Text),m=c(0),S=c(!1),l=c(!1),f=c([]),i=j(()=>{const a={};return S.value&&(_.value===""&&(a.text=t("Question required")),typeof m.value=="string"&&(a.position=t("The position must be a number"))),a}),B=z(V,async()=>{try{if(await N(k.test_id),!p.value){C("failure",t("Test Not Found."));return}}catch{C("failure",t("Error loading test."))}finally{}}),q=[];I(()=>{document.querySelectorAll(".app-main .label-info").forEach(n=>{q.push(new R(n,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),$(()=>{q.forEach(a=>a.dispose()),B()});async function F(){if(!(l.value||!p.value)){if(l.value=!0,S.value=!0,Object.keys(i.value).length>0){l.value=!1;return}try{await A(p.value,{text:_.value,max_points:0,choiceCount:0,type:h.value,position:Number(m.value)}),f.value=[],E.push({name:"edit-test",params:{test_id:k.test_id},query:{sF:0}})}catch(a){f.value=[t("Server Error")+M.value+": "+a.code]}finally{l.value=!1}}}return(a,n)=>(u(),G(ee,{test_id:a.test_id},{default:H(()=>{var T;return[e("div",te,[e("div",se,[e("div",oe,o(s(t)("Create Question")),1),f.value.length?(u(),d("div",ae,[e("ul",null,[(u(!0),d(y,null,K(f.value,r=>(u(),d("li",{key:r},o(r),1))),128))])])):b("",!0),e("div",ie,o((T=s(p))==null?void 0:T.name),1),e("div",ne,[e("label",le,o(s(t)("Question")),1),x(e("input",{type:"text",class:g(["form-control",{"is-invalid":i.value.text}]),id:"question-input-text","onUpdate:modelValue":n[0]||(n[0]=r=>_.value=r),disabled:l.value},null,10,ue),[[Q,_.value]]),i.value.text?(u(),d("div",re,o(i.value.text),1)):b("",!0)]),e("div",de,[e("label",ce,o(s(t)("Question Type")),1),x(e("select",{class:g(["form-select",{"is-invalid":i.value.type}]),id:"question-input-type","onUpdate:modelValue":n[1]||(n[1]=r=>h.value=r),disabled:l.value},[e("option",{value:s(v).Text},o(s(t)("Text")),9,pe),e("option",{value:s(v).MultipleChoice},o(s(t)("Multiple Choice")),9,_e),e("option",{value:s(v).Number},o(s(t)("Number")),9,me),e("option",{value:s(v).SingleChoice},o(s(t)("Single Choice")),9,fe)],10,ve),[[W,h.value]]),i.value.type?(u(),d("div",be,o(i.value.type),1)):b("",!0)]),e("div",he,[e("label",ye,o(s(t)("Position")),1),e("span",{class:"label-info","data-bs-content":s(t)("The position of the question in the test.")},n[3]||(n[3]=[e("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,xe),x(e("input",{type:"number",class:g(["form-control",{"is-invalid":i.value.position}]),id:"question-input-position","onUpdate:modelValue":n[2]||(n[2]=r=>m.value=r),disabled:l.value},null,10,ge),[[Q,m.value]]),i.value.position?(u(),d("div",ke,o(i.value.position),1)):b("",!0)]),e("button",{type:"button",class:"btn btn-primary",onClick:F,disabled:l.value},[l.value?(u(),d(y,{key:1},[w(o(s(t)("Creating"))+" ...",1)],64)):(u(),d(y,{key:0},[w(o(s(t)("Create")),1)],64))],8,Ce)])])]}),_:1},8,["test_id"]))}}),Ve=X(Se,[["__scopeId","data-v-5024c6de"]]);export{Ve as default};
