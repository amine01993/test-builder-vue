import{d as U,s as B,u as P,b as F,a as j,v as L,r as l,x as z,o as I,c as R,P as G,e as H,g as J,h as K,w as W,i as r,j as t,t as n,k as a,F as S,l as X,q as _,A as b,ae as Y,p as w,B as N,af as Z,C as Q}from"./index-CEw6Ur-o.js";import{a as $,b as ee}from"./testService-F-kZAI4C.js";import{Q as D}from"./Question-DJVAB3JS.js";import{A as te}from"./AppContainer-CrW-O1Ra.js";import"./firestore-O8Pw084e.js";const oe=U({__name:"CreateChoiceView",props:{test_id:{type:String,required:!0},question_id:{type:String,required:!0}},setup(c,{expose:i}){i();const u=B(),{t:e}=P(),{showMessage:v}=F(),{auth:f}=j(),{spaceLabel:m}=L(),{question:d,loadQuestion:o}=$(),{addChoice:E}=ee(),p=l(""),y=l(0),V=l(!1),C=l(0),x=l(!1),h=l(!1),g=l([]),A=z(()=>{const s={};return x.value&&(p.value===""&&(s.text=e("Choice required")),typeof y.value=="string"&&(s.points=e("Max points must be a number")),typeof C.value=="string"&&(s.position=e("The position must be a number"))),s}),T=I(f,async()=>{try{if(await o(c.test_id,c.question_id),!d.value){v("failure",e("Question Not Found."));return}}catch{v("failure",e("Error loading question."))}finally{}}),q=[];R(()=>{document.querySelectorAll(".app-main .label-info").forEach(k=>{q.push(new G(k,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),H(()=>{q.forEach(s=>s.dispose()),T()});async function O(){var s;if(!h.value){if(h.value=!0,x.value=!0,Object.keys(A.value).length>0){h.value=!1;return}try{await E(c.test_id,c.question_id,{text:p.value,points:Number(y.value),is_correct:V.value,position:Number(C.value),question:{type:((s=d.value)==null?void 0:s.type)??D.Text}}),g.value=[],u.push({name:"edit-question",params:{test_id:c.test_id,question_id:c.question_id},query:{sF:0}})}catch(k){g.value=[e("Server Error")+m.value+": "+k.code]}finally{h.value=!1}}}const M={router:u,t:e,showMessage:v,auth:f,spaceLabel:m,question:d,loadQuestion:o,addChoice:E,text:p,points:y,correctness:V,position:C,submitted:x,submitting:h,serverErrors:g,errors:A,onAuthEventDispose:T,popOvers:q,createChoice:O,get QuestionType(){return D},AppContainer:te};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),ie={class:"app-main"},se={class:"choice-form"},ne={class:"choice-form-title mb-4"},re={key:0,class:"alert alert-danger",role:"alert"},ae={class:"mb-3 question-text"},ce={class:"mb-3"},le={for:"choice-input-text",class:"form-label"},de=["type","disabled"],ue={key:0,class:"invalid-feedback is-invalid"},me={class:"mb-3"},he={for:"choice-input-pts",class:"form-label"},ve=["disabled"],_e={key:0,class:"invalid-feedback is-invalid"},be={class:"mb-3"},fe={class:"form-check"},pe={class:"form-check-label",for:"choice-input-correctness"},ye={class:"mb-3"},Ce={for:"choice-input-position",class:"form-label"},xe=["data-bs-content"],ge=["disabled"],qe={key:0,class:"invalid-feedback is-invalid"},ke=["disabled"];function Se(c,i,u,e,v,f){return r(),K(e.AppContainer,{test_id:u.test_id,question_id:u.question_id},{default:W(()=>{var m,d;return[t("div",ie,[t("div",se,[t("div",ne,n(e.t("Create Choice")),1),e.serverErrors.length?(r(),a("div",re,[t("ul",null,[(r(!0),a(S,null,X(e.serverErrors,o=>(r(),a("li",{key:o},n(o),1))),128))])])):_("",!0),t("div",ae,n((m=e.question)==null?void 0:m.text),1),t("div",ce,[t("label",le,n(e.t("Choice")),1),b(t("input",{type:((d=e.question)==null?void 0:d.type)===e.QuestionType.Number?"number":"text",class:w(["form-control",{"is-invalid":e.errors.text}]),id:"choice-input-text","onUpdate:modelValue":i[0]||(i[0]=o=>e.text=o),disabled:e.submitting},null,10,de),[[Y,e.text]]),e.errors.text?(r(),a("div",ue,n(e.errors.text),1)):_("",!0)]),t("div",me,[t("label",he,n(e.t("Points")),1),b(t("input",{type:"number",class:w(["form-control",{"is-invalid":e.errors.points}]),id:"choice-input-pts","onUpdate:modelValue":i[1]||(i[1]=o=>e.points=o),disabled:e.submitting},null,10,ve),[[N,e.points]]),e.errors.points?(r(),a("div",_e,n(e.errors.points),1)):_("",!0)]),t("div",be,[t("div",fe,[b(t("input",{class:"form-check-input",type:"checkbox",id:"choice-input-correctness","onUpdate:modelValue":i[2]||(i[2]=o=>e.correctness=o)},null,512),[[Z,e.correctness]]),t("label",pe,n(e.t("Correct Choice")),1)])]),t("div",ye,[t("label",Ce,n(e.t("Position")),1),t("span",{class:"label-info","data-bs-content":e.t("The position of the choice in the question.")},i[4]||(i[4]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,xe),b(t("input",{type:"number",class:w(["form-control",{"is-invalid":e.errors.position}]),id:"choice-input-position","onUpdate:modelValue":i[3]||(i[3]=o=>e.position=o),disabled:e.submitting},null,10,ge),[[N,e.position]]),e.errors.position?(r(),a("div",qe,n(e.errors.position),1)):_("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:e.createChoice,disabled:e.submitting},[e.submitting?(r(),a(S,{key:1},[Q(n(e.t("Creating"))+" ...",1)],64)):(r(),a(S,{key:0},[Q(n(e.t("Create")),1)],64))],8,ke)])])]}),_:1},8,["test_id","question_id"])}const Me=J(oe,[["render",Se],["__scopeId","data-v-dddaaafd"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/CreateChoiceView.vue"]]);export{Me as default};
