import{d as E,q as F,g as I,u as P,C as j,r as M,c as x,h as q,i as H,M as O,j as Q,_ as R,a as p,p as U,w as z,b as t,z as T,F as A,o as l,t as y,e as w,m as Y,l as G}from"./index-CGS4B7OT.js";import{u as J}from"./testService-DeBIOd3R.js";import{D as K}from"./DisplayQuestion-Bh6xTWWx.js";import{A as W}from"./AppContainer-BbQHt-u2.js";import"./firestore-B39V3hTY.js";import"./Question-DJVAB3JS.js";const X=E({__name:"PreviewTestView",props:{test_id:{type:String,required:!0}},setup(g,{expose:i}){i();const v=F(),{startLoading:e,endLoading:f,showMessage:b}=I(),{auth:u}=P(),{getTest:a}=J(),d=j("test-submission-modal"),r=M(),c=M(180);let n,o=null;const D=x(()=>{let s=c.value;const _=Math.floor(s/60/60);s=s-_*60*60;const h=Math.floor(s/60);s=s-h*60;const C=s;let m=[];return _&&m.push(_+"h"),h&&m.push(h+"min"),C&&m.push(C+"s"),m.length===0?"Time out":m.join(" ")}),L=x(()=>{var s;return(s=r.value)!=null&&s.description?r.value.description.replace(/\n/g,"<br />"):""}),S=q(u,async()=>{e();try{if(r.value=await a(g.test_id,!0),!r.value){b("failure","Test Not Found.");return}c.value=r.value.time_limit,n=setInterval(()=>{c.value--,c.value===0&&(clearInterval(n),n=void 0)},1e3)}catch{b("failure","Error loading test data.")}finally{f()}});H(()=>{d.value&&(o=new O(d.value,{backdrop:"static",keyboard:!1}))}),Q(()=>{S(),n!==void 0&&(clearInterval(n),n=void 0),o&&o.dispose()});function V(){window.scrollTo(0,0)}function N(){o&&o.show()}function B(){o&&(o.hide(),v.push({name:"tests"}))}const k={router:v,startLoading:e,endLoading:f,showMessage:b,auth:u,getTest:a,testSubmissionEl:d,test:r,time_limit:c,get interval(){return n},set interval(s){n=s},get testSubmissionModal(){return o},set testSubmissionModal(s){o=s},timeLimit:D,description:L,onAuthEventDispose:S,moveToTheTop:V,finishTest:N,submitTest:B,DisplayQuestion:K,AppContainer:W};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),Z={key:0,class:"app-test-header"},$={class:"test-name"},tt={class:"test-limit"},et={key:1,class:"app-test-description"},st=["innerHTML"],it={class:"test-points"},ot={key:2,class:"app-main"},nt={class:"modal",tabindex:"-1",ref:"test-submission-modal"};function at(g,i,v,e,f,b){return l(),p(A,null,[U(e.AppContainer,null,{default:z(()=>{var u;return[e.test?(l(),p("div",Z,[t("div",$,y(e.test.name),1),t("div",tt,[i[0]||(i[0]=t("i",{class:"bi bi-alarm"},null,-1)),T(" "+y(e.timeLimit),1)])])):w("",!0),e.test?(l(),p("div",et,[t("div",{class:"test-description",innerHTML:e.description},null,8,st),t("div",it," ("+y(e.test.max_points)+" pts) ",1)])):w("",!0),e.test?(l(),p("div",ot,[(l(!0),p(A,null,Y((u=e.test)==null?void 0:u.questions,(a,d)=>(l(),G(e.DisplayQuestion,{key:a.id,question:a,choices:a.choices,nbr:d+1,preview:!0},null,8,["question","choices","nbr"]))),128)),t("div",{class:"app-test-actions"},[t("button",{type:"button",class:"btn btn-outline-primary to-the-top",onClick:e.moveToTheTop},i[1]||(i[1]=[t("i",{class:"bi bi-arrow-up"},null,-1)])),t("button",{type:"button",class:"btn btn-primary",onClick:e.finishTest}," Finish The Test ")])])):w("",!0)]}),_:1}),t("div",nt,[t("div",{class:"modal-dialog modal-dialog-centered"},[t("div",{class:"modal-content"},[i[3]||(i[3]=t("div",{class:"modal-body"},[t("p",null,[T(" Are you sure you want to submit the test?"),t("br"),T(" You will not be able to continue the test once it is submitted. ")])],-1)),t("div",{class:"modal-footer"},[i[2]||(i[2]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:e.submitTest},"Submit")])])])],512)],64)}const pt=R(X,[["render",at],["__scopeId","data-v-66cf9a52"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/PreviewTestView.vue"]]);export{pt as default};
