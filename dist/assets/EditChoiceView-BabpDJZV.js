import{d as j,s as z,u as I,b as R,a as G,v as H,r as a,x as J,o as K,c as W,P as X,e as Y,g as Z,h as $,w as ee,i as c,j as t,t as n,k as l,F as k,l as te,q as f,A as _,ae as ie,p as E,B as P,af as oe,C as U}from"./index-CEw6Ur-o.js";import{a as se,b as ne}from"./testService-F-kZAI4C.js";import{Q as B}from"./Question-DJVAB3JS.js";import{A as re}from"./AppContainer-CrW-O1Ra.js";import"./firestore-O8Pw084e.js";const ae=j({__name:"EditChoiceView",props:{test_id:{type:String,required:!0},question_id:{type:String,required:!0},choice_id:{type:String,required:!0}},setup(r,{expose:s}){s();const d=z(),{t:e}=I(),{startLoading:p,endLoading:y,showMessage:o}=R(),{auth:S}=G(),{spaceLabel:w}=H(),{question:h,loadQuestion:T}=se(),{getChoice:V,updateChoice:A}=ne(),N=a(""),q=a(B.Text),v=a(""),m=a(0),g=a(!1),b=a(0),x=a(!1),u=a(!1),Q=a([]),D=J(()=>{const i={};return x.value&&(v.value===""&&(i.text=e("Choice required")),typeof m.value=="string"&&(i.points=e("Points must be a number")),typeof b.value=="string"&&(i.position=e("The position must be a number"))),i}),M=K(S,async()=>{p();try{if(await T(r.test_id,r.question_id),!h.value){o("failure",e("Question Not Found."));return}N.value=h.value.text,q.value=h.value.type;const i=await V(r.test_id,r.question_id,r.choice_id);if(!i){o("failure",e("Choice Not Found."));return}v.value=i.text,g.value=i.is_correct,m.value=i.points,b.value=i.position}catch{o("failure",e("Error loading data."))}finally{y()}}),C=[];W(()=>{document.querySelectorAll(".app-main .label-info").forEach(L=>{C.push(new X(L,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),Y(()=>{C.forEach(i=>i.dispose()),M()});async function F(){if(!u.value){if(u.value=!0,x.value=!0,Object.keys(D.value).length>0){u.value=!1;return}try{await A(r.test_id,r.question_id,r.choice_id,{text:v.value,is_correct:g.value,points:Number(m.value),position:Number(b.value),question:{type:q.value}}),o("success",e("Choice edited with success.")),d.push({name:"edit-question",params:{test_id:r.test_id,question_id:r.question_id},query:{sF:0}})}catch(i){Q.value=[e("Server Error")+w.value+": "+i.code]}finally{u.value=!1}}}const O={router:d,t:e,startLoading:p,endLoading:y,showMessage:o,auth:S,spaceLabel:w,question:h,loadQuestion:T,getChoice:V,updateChoice:A,questionText:N,questionType:q,text:v,points:m,correctness:g,position:b,submitted:x,submitting:u,serverErrors:Q,errors:D,onAuthEventDispose:M,popOvers:C,editChoice:F,get QuestionType(){return B},AppContainer:re};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),ce={class:"app-main"},le={class:"choice-form"},de={class:"choice-form-title mb-4"},ue={key:0,class:"alert alert-danger",role:"alert"},he={class:"mb-3 question-text"},ve={class:"mb-3"},me={for:"choice-input-text",class:"form-label"},be=["type","disabled"],fe={key:0,class:"invalid-feedback is-invalid"},_e={class:"mb-3"},pe={for:"choice-input-pts",class:"form-label"},ye=["disabled"],qe={key:0,class:"invalid-feedback is-invalid"},ge={class:"mb-3"},xe={class:"form-check"},Ce={class:"form-check-label",for:"choice-input-correctness"},ke={class:"mb-3"},Ee={for:"question-input-position",class:"form-label"},Se=["data-bs-content","aria-label"],we=["disabled"],Te={key:0,class:"invalid-feedback is-invalid"},Ve=["disabled"];function Ae(r,s,d,e,p,y){return c(),$(e.AppContainer,{test_id:d.test_id,question_id:d.question_id},{default:ee(()=>[t("div",ce,[t("div",le,[t("div",de,n(e.t("Edit Choice")),1),e.serverErrors.length?(c(),l("div",ue,[t("ul",null,[(c(!0),l(k,null,te(e.serverErrors,o=>(c(),l("li",{key:o},n(o),1))),128))])])):f("",!0),t("div",he,n(e.questionText),1),t("div",ve,[t("label",me,n(e.t("Choice")),1),_(t("input",{type:e.questionType===e.QuestionType.Number?"number":"text",class:E(["form-control",{"is-invalid":e.errors.text}]),id:"choice-input-text","onUpdate:modelValue":s[0]||(s[0]=o=>e.text=o),disabled:e.submitting},null,10,be),[[ie,e.text]]),e.errors.text?(c(),l("div",fe,n(e.errors.text),1)):f("",!0)]),t("div",_e,[t("label",pe,n(e.t("Points")),1),_(t("input",{type:"number",class:E(["form-control",{"is-invalid":e.errors.points}]),id:"choice-input-pts","onUpdate:modelValue":s[1]||(s[1]=o=>e.points=o),disabled:e.submitting},null,10,ye),[[P,e.points]]),e.errors.points?(c(),l("div",qe,n(e.errors.points),1)):f("",!0)]),t("div",ge,[t("div",xe,[_(t("input",{class:"form-check-input",type:"checkbox",id:"choice-input-correctness","onUpdate:modelValue":s[2]||(s[2]=o=>e.correctness=o)},null,512),[[oe,e.correctness]]),t("label",Ce,n(e.t("Correct Choice")),1)])]),t("div",ke,[t("label",Ee,n(e.t("Position")),1),t("button",{class:"label-info","data-bs-content":e.t("The position of the choice in the question."),"aria-label":e.t("The position of the choice in the question.")},s[4]||(s[4]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,Se),_(t("input",{type:"number",class:E(["form-control",{"is-invalid":e.errors.position}]),id:"question-input-position","onUpdate:modelValue":s[3]||(s[3]=o=>e.position=o),disabled:e.submitting},null,10,we),[[P,e.position]]),e.errors.position?(c(),l("div",Te,n(e.errors.position),1)):f("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:e.editChoice,disabled:e.submitting},[e.submitting?(c(),l(k,{key:1},[U(n(e.t("Editing"))+" ...",1)],64)):(c(),l(k,{key:0},[U(n(e.t("Edit")),1)],64))],8,Ve)])])]),_:1},8,["test_id","question_id"])}const Pe=Z(ae,[["render",Ae],["__scopeId","data-v-f5467906"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/EditChoiceView.vue"]]);export{Pe as default};
