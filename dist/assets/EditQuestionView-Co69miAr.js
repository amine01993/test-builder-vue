const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ChoiceItem-C7OVw45c.js","assets/index-D9eu1wvy.js","assets/index-PsUf1Fe-.css","assets/choiceItem-BeFWPQ3K.js","assets/testService-z9XHGfAc.js","assets/firestore-CkCHjU9t.js","assets/Question-DJVAB3JS.js","assets/ChoiceItemD-C24AueRd.js"])))=>i.map(i=>d[i]);
import{d as ne,u as le,b as ue,v as de,a as ce,r as p,x as re,o as ve,c as he,P as _e,e as pe,f as V,w,L as me,y as be,z as fe,g as n,h as t,m as f,t as s,i as e,j as u,F as m,k as T,p as k,A as Q,B as U,S as ye,C as S,l as q,I as B,q as z,_ as j,s as ge}from"./index-D9eu1wvy.js";import{d as $}from"./vuedraggable.umd-xbOzwnf8.js";import{u as ke,a as qe,b as Ee}from"./testService-z9XHGfAc.js";import{Q as E}from"./Question-DJVAB3JS.js";import{_ as xe}from"./AppContainer.vue_vue_type_script_setup_true_lang-Ci2WOSVt.js";import"./firestore-CkCHjU9t.js";const Ce={class:"app-main"},we={class:"question-form-title mb-4"},Se=["aria-label"],Ve={key:0,class:"alert alert-danger",role:"alert"},Te={class:"mb-3 test-name"},Qe={class:"mb-3"},Le={for:"question-input-text",class:"form-label"},Pe=["disabled","tabindex"],Ne={key:0,class:"invalid-feedback is-invalid"},Ae={class:"mb-3"},Fe={for:"question-input-type",class:"form-label"},De=["disabled","tabindex"],Ie=["value"],Me=["value"],Re=["value"],Oe=["value"],Ue={key:0,class:"invalid-feedback is-invalid"},Be={class:"mb-3"},ze={for:"question-input-position",class:"form-label"},je=["data-bs-content","aria-label","tabindex"],$e=["disabled","tabindex"],Ge={key:0,class:"invalid-feedback is-invalid"},He=["disabled","tabindex"],Je={class:"choice-actions"},Ke={key:0,class:"choice-info"},We={key:0,class:"placeholder-wave"},Xe={class:"choice-info-label"},Ye={key:1,class:"choice-list"},Ze={key:2,class:"choice-list"},et={scope:"col"},tt={scope:"col"},ot={scope:"col"},st={scope:"col"},it={scope:"col"},at={scope:"col"},nt={key:1},lt=ne({__name:"EditQuestionView",props:{test_id:{},question_id:{}},setup(v){const{t:o}=le(),G=me(),L=be(),{isDesktop:H,startLoading:J,endLoading:K,showMessage:_}=ue(),{spaceLabel:P}=de(),{auth:W}=ce(),{test:N,loadTest:X}=ke(),{question:b,loadQuestion:Y,updateQuestion:Z}=qe(),{choices:c,loadChoices:ee,updateChoicesPositions:te}=Ee(),A=z(()=>j(()=>import("./ChoiceItem-C7OVw45c.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),F=z(()=>j(()=>import("./ChoiceItemD-C24AueRd.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),y=p(""),x=p(E.Text),g=p(0),d=p(G.query.sF!="0"),D=p(!1),h=p(!1),C=p([]),r=re(()=>{const i={};return D.value&&(y.value===""&&(i.text=o("Question required")),typeof g.value=="string"&&(i.position=o("The position must be a number"))),i}),oe=ve(W,async()=>{d.value&&J();try{if(await X(v.test_id),!N.value){_("failure",o("Test Not Found."));return}}catch{_("failure",o("Error loading test."))}finally{}try{if(await Y(v.test_id,v.question_id),!b.value){_("failure",o("Question Not Found."));return}y.value=b.value.text,x.value=b.value.type,g.value=b.value.position}catch{_("failure",o("Error loading question data."))}finally{d.value&&K()}try{b.value&&await ee(v.test_id,b.value)}catch(i){console.log("EditQuestionView",i),_("failure",o("Error loading choices."))}}),I=[];he(()=>{document.querySelectorAll(".app-main .label-info").forEach(l=>{I.push(new _e(l,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),pe(()=>{I.forEach(i=>i.dispose()),oe()});async function se(){if(!h.value){if(h.value=!0,D.value=!0,Object.keys(r.value).length>0){h.value=!1;return}try{await Z(v.test_id,v.question_id,{text:y.value,type:x.value,position:Number(g.value)}),C.value=[],_("success",o("Question edited with success.")),L.push({name:"edit-test",params:{test_id:v.test_id},query:{sF:0}})}catch(i){C.value=[o("Server Error")+P.value+": "+i.code]}finally{h.value=!1}}}function ie(){d.value=!d.value,L.push({query:{sF:d.value?1:0}})}function M(){te(v.test_id,v.question_id).then(()=>{_("success",o("Positions updated with success."))}).catch(i=>{_("failure",o("Sorry! Positions can not be updated."))})}return(i,l)=>{const ae=fe("RouterLink");return n(),V(xe,{test_id:i.test_id},{default:w(()=>{var R,O;return[t("div",Ce,[t("div",{class:f(["question-form",{"hide-form":!d.value}])},[t("div",we,s(e(o)("Edit Question")),1),t("button",{class:"btn toggle-form-btn",onClick:ie,"aria-label":d.value?e(o)("hide editing form"):e(o)("show editing form")},[t("i",{class:f(["bi",{"bi-chevron-down":!d.value,"bi-chevron-up":d.value}])},null,2)],8,Se),C.value.length?(n(),u("div",Ve,[t("ul",null,[(n(!0),u(m,null,T(C.value,a=>(n(),u("li",{key:a},s(a),1))),128))])])):k("",!0),t("div",Te,s((R=e(N))==null?void 0:R.name),1),t("div",Qe,[t("label",Le,s(e(o)("Question")),1),Q(t("input",{type:"text",class:f(["form-control",{"is-invalid":r.value.text}]),id:"question-input-text","onUpdate:modelValue":l[0]||(l[0]=a=>y.value=a),disabled:h.value,tabindex:d.value?void 0:-1,"aria-required":""},null,10,Pe),[[U,y.value]]),r.value.text?(n(),u("div",Ne,s(r.value.text),1)):k("",!0)]),t("div",Ae,[t("label",Fe,s(e(o)("Question Type")),1),Q(t("select",{class:f(["form-select",{"is-invalid":r.value.type}]),id:"question-input-type","onUpdate:modelValue":l[1]||(l[1]=a=>x.value=a),disabled:h.value,tabindex:d.value?void 0:-1},[t("option",{value:e(E).Text},s(e(o)("Text")),9,Ie),t("option",{value:e(E).MultipleChoice},s(e(o)("Multiple Choice")),9,Me),t("option",{value:e(E).Number},s(e(o)("Number")),9,Re),t("option",{value:e(E).SingleChoice},s(e(o)("Single Choice")),9,Oe)],10,De),[[ye,x.value]]),r.value.type?(n(),u("div",Ue,s(r.value.type),1)):k("",!0)]),t("div",Be,[t("label",ze,s(e(o)("Position")),1),t("button",{class:"label-info","data-bs-content":e(o)("The position of the question in the test."),"aria-label":e(o)("The position of the question in the test."),tabindex:d.value?void 0:-1},l[5]||(l[5]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,je),Q(t("input",{type:"number",class:f(["form-control",{"is-invalid":r.value.position}]),id:"question-input-position","onUpdate:modelValue":l[2]||(l[2]=a=>g.value=a),disabled:h.value,tabindex:d.value?void 0:-1},null,10,$e),[[U,g.value]]),r.value.position?(n(),u("div",Ge,s(r.value.position),1)):k("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:se,disabled:h.value,tabindex:d.value?void 0:-1},[h.value?(n(),u(m,{key:1},[S(s(e(o)("Editing"))+" ...",1)],64)):(n(),u(m,{key:0},[S(s(e(o)("Edit")),1)],64))],8,He)],2)]),t("div",Je,[q(ae,{to:{name:"create-choice",params:{test_id:i.test_id,question_id:i.question_id}},class:"btn btn-warning"},{default:w(()=>[S(s(e(o)("Create New Choice")),1)]),_:1},8,["to"])]),!e(c)||e(c).length>0?(n(),u("div",Ke,[e(c)?(n(),u(m,{key:1},[t("span",Xe,s(e(o)("Total number of choices"))+s(e(P))+":",1),S(" "+s((O=e(c))==null?void 0:O.length),1)],64)):(n(),u("div",We,l[6]||(l[6]=[t("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])):k("",!0),e(H)?(n(),u("div",Ze,[t("table",{class:f(["table",{loading:!e(c)}])},[t("thead",null,[t("tr",null,[l[7]||(l[7]=t("th",{scope:"col"},null,-1)),t("th",et,s(e(o)("Choice")),1),t("th",tt,s(e(o)("Points")),1),t("th",ot,s(e(o)("Is Correct?")),1),t("th",st,s(e(o)("Position")),1),t("th",it,s(e(o)("Last updated at")),1),t("th",at,s(e(o)("Actions")),1)])]),e(c)?(n(),V(e($),{key:0,modelValue:e(c),"onUpdate:modelValue":l[4]||(l[4]=a=>B(c)?c.value=a:null),"item-key":"id",tag:"tbody",handle:".choice-item-sort-handler",onEnd:M},{item:w(({element:a})=>[q(e(F),{test_id:i.test_id,question_id:i.question_id,choice:a},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(n(),u("tbody",nt,[(n(),u(m,null,T(5,a=>q(e(F),{key:"choice-placeholder-"+a})),64))]))],2)])):(n(),u(m,{key:1},[e(c)?(n(),V(e($),{key:0,modelValue:e(c),"onUpdate:modelValue":l[3]||(l[3]=a=>B(c)?c.value=a:null),"item-key":"id",tag:"div","component-data":{class:"choice-list"},handle:".choice-item-sort-handler",onEnd:M},{item:w(({element:a})=>[q(e(A),{test_id:i.test_id,question_id:i.question_id,choice:a},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(n(),u("div",Ye,[(n(),u(m,null,T([0,1,2],a=>q(e(A),{key:"choice-placeholder-"+a})),64))]))],64))]}),_:1},8,["test_id"])}}}),_t=ge(lt,[["__scopeId","data-v-b2b85c3e"]]);export{_t as default};
