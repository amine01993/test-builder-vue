const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ChoiceItem-Ck-5EYMH.js","assets/index-B1zD-M5g.js","assets/index-p0O6aTzZ.css","assets/choiceItem-C-8l72w9.js","assets/testService-CFPtsndb.js","assets/firestore-qVOR4QEO.js","assets/Question-DJVAB3JS.js","assets/ChoiceItemD-D1StHZo2.js"])))=>i.map(i=>d[i]);
import{d as ae,u as le,b as ue,v as de,a as ce,r as p,x as re,o as ve,c as he,P as _e,e as pe,f as V,w,J as me,y as fe,z as be,g as a,h as t,m as b,t as s,i as e,j as u,F as m,k as T,p as k,A as Q,B as O,S as ye,C as S,l as q,I as U,q as B,_ as z,s as ge}from"./index-B1zD-M5g.js";import{d as j}from"./vuedraggable.umd-BHMgI6zF.js";import{u as ke,a as qe,b as Ee}from"./testService-CFPtsndb.js";import{Q as E}from"./Question-DJVAB3JS.js";import{_ as xe}from"./AppContainer.vue_vue_type_script_setup_true_lang-5ZPq4PI3.js";import"./firestore-qVOR4QEO.js";const Ce={class:"app-main"},we={class:"question-form-title mb-4"},Se=["aria-label"],Ve={key:0,class:"alert alert-danger",role:"alert"},Te={class:"mb-3 test-name"},Qe={class:"mb-3"},Pe={for:"question-input-text",class:"form-label"},Le=["disabled","tabindex"],Ne={key:0,class:"invalid-feedback is-invalid"},Ae={class:"mb-3"},De={for:"question-input-type",class:"form-label"},Fe=["disabled","tabindex"],Ie=["value"],Me=["value"],Re=["value"],Oe=["value"],Ue={key:0,class:"invalid-feedback is-invalid"},Be={class:"mb-3"},ze={for:"question-input-position",class:"form-label"},je=["data-bs-content","aria-label","tabindex"],Je=["disabled","tabindex"],$e={key:0,class:"invalid-feedback is-invalid"},Ge=["disabled","tabindex"],He={class:"choice-actions"},Ke={key:0,class:"choice-info"},We={key:0,class:"placeholder-wave"},Xe={class:"choice-info-label"},Ye={key:1,class:"choice-list"},Ze={key:2,class:"choice-list"},et={scope:"col"},tt={scope:"col"},ot={scope:"col"},st={scope:"col"},it={scope:"col"},nt={scope:"col"},at={key:1},lt=ae({__name:"EditQuestionView",props:{test_id:{},question_id:{}},setup(h){const{t:o}=le(),J=me(),$=fe(),{isDesktop:G,startLoading:H,endLoading:K,showMessage:_}=ue(),{spaceLabel:P}=de(),{auth:W}=ce(),{test:L,loadTest:X}=ke(),{question:f,loadQuestion:Y,updateQuestion:Z}=qe(),{choices:c,loadChoices:ee,updateChoicesPositions:te}=Ee(),N=B(()=>z(()=>import("./ChoiceItem-Ck-5EYMH.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),A=B(()=>z(()=>import("./ChoiceItemD-D1StHZo2.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),y=p(""),x=p(E.Text),g=p(0),d=p(J.query.sF!="0"),D=p(!1),v=p(!1),C=p([]),r=re(()=>{const i={};return D.value&&(y.value===""&&(i.text=o("Question required")),typeof g.value=="string"&&(i.position=o("The position must be a number"))),i}),oe=ve(W,async()=>{d.value&&H();try{if(await X(h.test_id),!L.value){_("failure",o("Test Not Found."));return}}catch{_("failure",o("Error loading test."))}finally{}try{if(await Y(h.test_id,h.question_id),!f.value){_("failure",o("Question Not Found."));return}y.value=f.value.text,x.value=f.value.type,g.value=f.value.position}catch{_("failure",o("Error loading question data."))}finally{d.value&&K()}try{f.value&&await ee(h.test_id,f.value)}catch(i){console.log("EditQuestionView",i),_("failure",o("Error loading choices."))}}),F=[];he(()=>{document.querySelectorAll(".app-main .label-info").forEach(l=>{F.push(new _e(l,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),pe(()=>{F.forEach(i=>i.dispose()),oe()});async function se(){if(!v.value){if(v.value=!0,D.value=!0,Object.keys(r.value).length>0){v.value=!1;return}try{await Z(h.test_id,h.question_id,{text:y.value,type:x.value,position:Number(g.value)}),C.value=[],_("success",o("Question edited with success."))}catch(i){C.value=[o("Server Error")+P.value+": "+i.code]}finally{v.value=!1}}}function ie(){d.value=!d.value,$.push({query:{sF:d.value?1:0}})}function I(){te(h.test_id,h.question_id).then(()=>{_("success",o("Positions updated with success."))}).catch(i=>{_("failure",o("Sorry! Positions can not be updated."))})}return(i,l)=>{const ne=be("RouterLink");return a(),V(xe,{test_id:i.test_id},{default:w(()=>{var M,R;return[t("div",Ce,[t("div",{class:b(["question-form",{"hide-form":!d.value}])},[t("div",we,s(e(o)("Edit Question")),1),t("button",{class:"btn toggle-form-btn",onClick:ie,"aria-label":d.value?e(o)("hide editing form"):e(o)("show editing form")},[t("i",{class:b(["bi",{"bi-chevron-down":!d.value,"bi-chevron-up":d.value}])},null,2)],8,Se),C.value.length?(a(),u("div",Ve,[t("ul",null,[(a(!0),u(m,null,T(C.value,n=>(a(),u("li",{key:n},s(n),1))),128))])])):k("",!0),t("div",Te,s((M=e(L))==null?void 0:M.name),1),t("div",Qe,[t("label",Pe,s(e(o)("Question")),1),Q(t("input",{type:"text",class:b(["form-control",{"is-invalid":r.value.text}]),id:"question-input-text","onUpdate:modelValue":l[0]||(l[0]=n=>y.value=n),disabled:v.value,tabindex:d.value?void 0:-1},null,10,Le),[[O,y.value]]),r.value.text?(a(),u("div",Ne,s(r.value.text),1)):k("",!0)]),t("div",Ae,[t("label",De,s(e(o)("Question Type")),1),Q(t("select",{class:b(["form-select",{"is-invalid":r.value.type}]),id:"question-input-type","onUpdate:modelValue":l[1]||(l[1]=n=>x.value=n),disabled:v.value,tabindex:d.value?void 0:-1},[t("option",{value:e(E).Text},s(e(o)("Text")),9,Ie),t("option",{value:e(E).MultipleChoice},s(e(o)("Multiple Choice")),9,Me),t("option",{value:e(E).Number},s(e(o)("Number")),9,Re),t("option",{value:e(E).SingleChoice},s(e(o)("Single Choice")),9,Oe)],10,Fe),[[ye,x.value]]),r.value.type?(a(),u("div",Ue,s(r.value.type),1)):k("",!0)]),t("div",Be,[t("label",ze,s(e(o)("Position")),1),t("button",{class:"label-info","data-bs-content":e(o)("The position of the question in the test."),"aria-label":e(o)("The position of the question in the test."),tabindex:d.value?void 0:-1},l[5]||(l[5]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,je),Q(t("input",{type:"number",class:b(["form-control",{"is-invalid":r.value.position}]),id:"question-input-position","onUpdate:modelValue":l[2]||(l[2]=n=>g.value=n),disabled:v.value,tabindex:d.value?void 0:-1},null,10,Je),[[O,g.value]]),r.value.position?(a(),u("div",$e,s(r.value.position),1)):k("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:se,disabled:v.value,tabindex:d.value?void 0:-1},[v.value?(a(),u(m,{key:1},[S(s(e(o)("Editing"))+" ...",1)],64)):(a(),u(m,{key:0},[S(s(e(o)("Edit")),1)],64))],8,Ge)],2)]),t("div",He,[q(ne,{to:{name:"create-choice",params:{test_id:i.test_id,question_id:i.question_id}},class:"btn btn-warning"},{default:w(()=>[S(s(e(o)("Create New Choice")),1)]),_:1},8,["to"])]),!e(c)||e(c).length>0?(a(),u("div",Ke,[e(c)?(a(),u(m,{key:1},[t("span",Xe,s(e(o)("Total number of choices"))+s(e(P))+":",1),S(" "+s((R=e(c))==null?void 0:R.length),1)],64)):(a(),u("div",We,l[6]||(l[6]=[t("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])):k("",!0),e(G)?(a(),u("div",Ze,[t("table",{class:b(["table",{loading:!e(c)}])},[t("thead",null,[t("tr",null,[l[7]||(l[7]=t("th",{scope:"col"},null,-1)),t("th",et,s(e(o)("Choice")),1),t("th",tt,s(e(o)("Points")),1),t("th",ot,s(e(o)("Is Correct?")),1),t("th",st,s(e(o)("Position")),1),t("th",it,s(e(o)("Last updated at")),1),t("th",nt,s(e(o)("Actions")),1)])]),e(c)?(a(),V(e(j),{key:0,modelValue:e(c),"onUpdate:modelValue":l[4]||(l[4]=n=>U(c)?c.value=n:null),"item-key":"id",tag:"tbody",handle:".choice-item-sort-handler",onEnd:I},{item:w(({element:n})=>[q(e(A),{test_id:i.test_id,question_id:i.question_id,choice:n},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(a(),u("tbody",at,[(a(),u(m,null,T(5,n=>q(e(A),{key:"choice-placeholder-"+n})),64))]))],2)])):(a(),u(m,{key:1},[e(c)?(a(),V(e(j),{key:0,modelValue:e(c),"onUpdate:modelValue":l[3]||(l[3]=n=>U(c)?c.value=n:null),"item-key":"id",tag:"div","component-data":{class:"choice-list"},handle:".choice-item-sort-handler",onEnd:I},{item:w(({element:n})=>[q(e(N),{test_id:i.test_id,question_id:i.question_id,choice:n},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(a(),u("div",Ye,[(a(),u(m,null,T([0,1,2],n=>q(e(N),{key:"choice-placeholder-"+n})),64))]))],64))]}),_:1},8,["test_id"])}}}),_t=ge(lt,[["__scopeId","data-v-1df01f63"]]);export{_t as default};
