import{q as P,g as R,B as F,C as H,r as q,c as A,i as V,j as O,d as x,_ as M,v as U,o as i,a,b as s,t as f,n as k,e as S,p as _,w as b,f as z,R as N,F as p,u as Y,h as Q,k as G,l as h,z as E,m as D}from"./index-CGS4B7OT.js";import{u as j}from"./testService-DeBIOd3R.js";import{A as J}from"./AppContainer-BbQHt-u2.js";import"./firestore-B39V3hTY.js";import"./Question-DJVAB3JS.js";function B(r){const e=P(),{showMessage:n,startLoading:t,endLoading:u}=R(),{deleteTest:m}=j(),{confirm:o}=F(),l=H("test-description"),y=q(!1),g=new Date,L=A(()=>y.value?r.description.replace(/\n/g,"<br />"):r.description.replace(/\n/g,"")),v=A(()=>{const d=r.updated_at.toDate();return new Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:g.getFullYear()===d.getFullYear()?void 0:"numeric",hour:"numeric",minute:"numeric"}).format(d)});V(()=>{l.value&&l.value.addEventListener("click",c)}),O(()=>{l.value&&l.value.removeEventListener("click",c)});function c(){y.value=!0}function w(){r&&o(`Are you sure you want to delete this test: "${r.name}"?`,"Delete",T)}async function T(){if(r!=null&&r.id)try{t(),await m(r.id),n("success","Test deleted with success.")}catch{n("failure","Test can not be deleted.")}finally{u()}}function C(){const d=e.resolve({name:"test-portal",params:{test_id:r.id}}),I=location.origin+d.fullPath;navigator.clipboard.writeText(I).then(()=>{n("success","Test link copied!")}).catch(()=>{n("failure","Sorry, Test link couldn't be copied!")})}return{showMore:y,description:L,updatedAt:v,confirmTestdeletion:w,copyTestLink:C}}const K=x({__name:"TestItem",props:{test:{type:Object,required:!1}},setup(r,{expose:e}){e();const{showMore:n,description:t,updatedAt:u,confirmTestdeletion:m,copyTestLink:o}=B(r.test),l={showMore:n,description:t,updatedAt:u,confirmTestdeletion:m,copyTestLink:o};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),W={key:0,class:"test-item-content"},X={class:"test-item-title"},Z={class:"test-item-info"},$=["innerHTML"],tt={class:"test-property"},et={class:"test-property"},st={key:0,class:"test-property"},nt={class:"test-last-update"},ot={class:"test-item-actions"},it={key:1,class:"test-item-content"};function rt(r,e,n,t,u,m){const o=U("RouterLink");return i(),a("div",{class:k(["test-item-container",{"placeholder-wave":!n.test}])},[n.test?(i(),a("div",W,[s("div",X,f(n.test.name),1),e[6]||(e[6]=s("hr",{class:"test-item-divider"},null,-1)),s("div",Z,[s("div",{class:k(["test-description",{"full-text":t.showMore}]),ref:"test-description",innerHTML:t.description},null,10,$),s("div",tt,"Max Score: "+f(n.test.max_points),1),s("div",et,"Time Limit: "+f(n.test.time_limit),1),n.test.questionCount?(i(),a("div",st,"Total number of questions: "+f(n.test.questionCount),1)):S("",!0),s("div",nt,"Last updated at: "+f(t.updatedAt),1)]),e[7]||(e[7]=s("hr",{class:"test-item-divider"},null,-1)),s("div",ot,[_(o,{to:{name:"preview-test",params:{test_id:n.test.id}},class:"btn btn-primary"},{default:b(()=>e[2]||(e[2]=[s("i",{class:"bi bi-eye-fill"},null,-1)])),_:1},8,["to"]),_(o,{to:{name:"edit-test",params:{test_id:n.test.id}},class:"btn btn-success"},{default:b(()=>e[3]||(e[3]=[s("i",{class:"bi bi-pencil-fill"},null,-1)])),_:1},8,["to"]),s("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...l)=>t.confirmTestdeletion&&t.confirmTestdeletion(...l))},e[4]||(e[4]=[s("i",{class:"bi bi-trash3-fill"},null,-1)])),s("button",{type:"button",class:"btn btn-warning",onClick:e[1]||(e[1]=(...l)=>t.copyTestLink&&t.copyTestLink(...l))},e[5]||(e[5]=[s("i",{class:"bi bi-copy"},null,-1)]))])])):(i(),a("div",it,e[8]||(e[8]=[z('<div class="test-item-title placeholder col-6 offset-3 placeholder-lg bg-secondary"></div><hr class="test-item-divider"><div class="test-item-info"><div class="placeholder col-12 bg-secondary" style="min-height:4em;"></div><div class="placeholder col-8 offset-4 placeholder-sm bg-secondary"></div></div><hr class="test-item-divider"><div class="test-item-actions placeholder col-9 offset-3 placeholder-lg bg-secondary"></div>',5)])))],2)}const lt=M(K,[["render",rt],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/components/items/TestItem.vue"]]),at=x({__name:"TestItemD",props:{test:{type:Object,required:!1}},setup(r,{expose:e}){e();const{showMore:n,description:t,updatedAt:u,confirmTestdeletion:m,copyTestLink:o}=B(r.test),l={showMore:n,description:t,updatedAt:u,confirmTestdeletion:m,copyTestLink:o,get RouterLink(){return N}};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}}),ct=["innerHTML"],dt={class:"test-property"},ut={class:"test-property"},mt={class:"test-property"},ft={class:"test-last-update"},pt={class:"test-item-actions-container"},_t={class:"test-item-actions"},yt={key:1,colspan:"7",class:"placeholder bg-secondary"};function vt(r,e,n,t,u,m){return i(),a("tr",{class:k(["test-item-container",{"placeholder-wave":!n.test}])},[n.test?(i(),a(p,{key:0},[s("th",null,f(n.test.name),1),s("td",{class:k(["test-description",{"full-text":t.showMore}]),ref:"test-description",innerHTML:t.description},null,10,ct),s("td",dt,f(n.test.max_points),1),s("td",ut,f(n.test.time_limit),1),s("td",mt,f(n.test.questionCount),1),s("td",ft,f(t.updatedAt),1),s("td",pt,[s("div",_t,[_(t.RouterLink,{to:{name:"preview-test",params:{test_id:n.test.id}},class:"btn btn-primary"},{default:b(()=>e[2]||(e[2]=[s("i",{class:"bi bi-eye-fill"},null,-1)])),_:1},8,["to"]),_(t.RouterLink,{to:{name:"edit-test",params:{test_id:n.test.id}},class:"btn btn-success"},{default:b(()=>e[3]||(e[3]=[s("i",{class:"bi bi-pencil-fill"},null,-1)])),_:1},8,["to"]),s("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...o)=>t.confirmTestdeletion&&t.confirmTestdeletion(...o))},e[4]||(e[4]=[s("i",{class:"bi bi-trash3-fill"},null,-1)])),s("button",{type:"button",class:"btn btn-warning",onClick:e[1]||(e[1]=(...o)=>t.copyTestLink&&t.copyTestLink(...o))},e[5]||(e[5]=[s("i",{class:"bi bi-copy"},null,-1)]))])])],64)):(i(),a("td",yt))],2)}const bt=M(at,[["render",vt],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/components/items/TestItemD.vue"]]),Tt=x({__name:"TestsView",setup(r,{expose:e}){e();const{isDesktop:n,showMessage:t}=R(),{auth:u,user:m}=Y(),{testCount:o,tests:l,loadTestCount:y,loadTests:g,loadMoreTests:L}=j(),v=q(!1);let c=null;const w=Q(u,async d=>{try{if(d===null)return;await Promise.all([y(d.uid),g(d.uid)]),c||(c=document.querySelector(".tests-loader"))}catch{t("failure","Error loading tests.")}});V(()=>{document.addEventListener("scroll",T),c||(c=document.querySelector(".tests-loader"))}),O(()=>{w(),document.removeEventListener("scroll",T)});async function T(){if(c&&!v.value&&c.getBoundingClientRect().top<window.innerHeight&&m.value){v.value=!0;try{await L(),await G(),c=document.querySelector(".tests-loader")}catch{t("failure","Error loading more tests.")}finally{v.value=!1}}}const C={isDesktop:n,showMessage:t,auth:u,user:m,testCount:o,tests:l,loadTestCount:y,loadTests:g,loadMoreTests:L,loadingTests:v,get testsLoaderEl(){return c},set testsLoaderEl(d){c=d},onAuthEventDispose:w,checkLoaderVisiblity:T,get RouterLink(){return N},AppContainer:J,TestItem:lt,TestItemD:bt};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),ht={class:"app-main"},kt={class:"test-actions"},gt={key:0,class:"test-info"},Lt={key:1,class:"placeholder-wave"},wt={class:"test-list"};function Ct(r,e,n,t,u,m){return i(),h(t.AppContainer,null,{default:b(()=>[s("div",ht,[s("div",kt,[_(t.RouterLink,{to:{name:"create-test"},class:"btn btn-warning create-test"},{default:b(()=>e[0]||(e[0]=[E("Create New Test")])),_:1})]),t.testCount!==0?(i(),a("div",gt,[t.testCount?(i(),a(p,{key:0},[e[1]||(e[1]=s("span",{class:"test-info-label"},"Total number of tests:",-1)),E(" "+f(t.testCount),1)],64)):(i(),a("div",Lt,e[2]||(e[2]=[s("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])):S("",!0),s("div",wt,[t.isDesktop?(i(),a("table",{key:1,class:k(["table",{loading:!t.tests}])},[e[3]||(e[3]=s("thead",null,[s("tr",null,[s("th",{scope:"col"},"Test"),s("th",{scope:"col"},"Description"),s("th",{scope:"col"},"Max Points"),s("th",{scope:"col"},"Time Limit"),s("th",{scope:"col"},"Nbr of Questions"),s("th",{scope:"col"},"Last updated at"),s("th",{scope:"col"},"Actions")])],-1)),s("tbody",null,[t.tests?(i(!0),a(p,{key:0},D(t.tests,o=>(i(),h(t.TestItemD,{test:o,key:o.id},null,8,["test"]))),128)):(i(),a(p,{key:1},D(5,o=>_(t.TestItemD,{key:"test-placeholder-"+o})),64)),t.testCount&&t.tests&&t.tests.length<t.testCount?(i(),h(t.TestItemD,{key:"test-placeholder-loading",class:"tests-loader"})):S("",!0)])],2)):(i(),a(p,{key:0},[t.tests?(i(!0),a(p,{key:0},D(t.tests,o=>(i(),h(t.TestItem,{test:o,key:o.id},null,8,["test"]))),128)):(i(),a(p,{key:1},D([0,1,2],o=>_(t.TestItem,{key:"test-placeholder-"+o})),64)),t.testCount&&t.tests&&t.tests.length<t.testCount?(i(),h(t.TestItem,{key:"test-placeholder-loading",class:"tests-loader"})):S("",!0)],64))])])]),_:1})}const At=M(Tt,[["render",Ct],["__scopeId","data-v-8faed77a"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/TestsView.vue"]]);export{At as default};
