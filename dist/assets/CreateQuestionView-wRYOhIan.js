import{d as B,s as D,u as U,b as F,a as P,v as j,r as l,x as L,o as z,c as I,P as R,e as G,g as H,h as J,w as K,i as r,j as t,t as o,k as a,F as x,l as W,q as _,A as C,B as V,p as Q,N as X,C as A}from"./index-CEw6Ur-o.js";import{u as Y,a as Z}from"./testService-F-kZAI4C.js";import{Q as N}from"./Question-DJVAB3JS.js";import{A as $}from"./AppContainer-CrW-O1Ra.js";import"./firestore-O8Pw084e.js";const ee=B({__name:"CreateQuestionView",props:{test_id:{type:String,required:!0}},setup(m,{expose:i}){i();const u=D(),{t:e}=U(),{showMessage:v}=F(),{auth:p}=P(),{spaceLabel:d}=j(),{test:s,loadTest:k}=Y(),{addQuestion:S}=Z(),b=l(""),T=l(N.Text),f=l(0),h=l(!1),c=l(!1),y=l([]),q=L(()=>{const n={};return h.value&&(b.value===""&&(n.text=e("Question required")),typeof f.value=="string"&&(n.position=e("The position must be a number"))),n}),w=z(p,async()=>{try{if(await k(m.test_id),!s.value){v("failure",e("Test Not Found."));return}}catch{v("failure",e("Error loading test."))}finally{}}),g=[];I(()=>{document.querySelectorAll(".app-main .label-info").forEach(O=>{g.push(new R(O,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),G(()=>{g.forEach(n=>n.dispose()),w()});async function M(){if(!(c.value||!s.value)){if(c.value=!0,h.value=!0,Object.keys(q.value).length>0){c.value=!1;return}try{await S(s.value,{text:b.value,max_points:0,choiceCount:0,type:T.value,position:Number(f.value)}),y.value=[],u.push({name:"edit-test",params:{test_id:m.test_id},query:{sF:0}})}catch(n){y.value=[e("Server Error")+d.value+": "+n.code]}finally{c.value=!1}}}const E={router:u,t:e,showMessage:v,auth:p,spaceLabel:d,test:s,loadTest:k,addQuestion:S,text:b,type:T,position:f,submitted:h,submitting:c,serverErrors:y,errors:q,onAuthEventDispose:w,popOvers:g,createQuestion:M,get QuestionType(){return N},AppContainer:$};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),te={class:"app-main"},oe={class:"question-form"},se={class:"question-form-title mb-4"},ie={key:0,class:"alert alert-danger",role:"alert"},ne={class:"mb-3 test-name"},re={class:"mb-3"},ae={for:"question-input-text",class:"form-label"},le=["disabled"],de={key:0,class:"invalid-feedback is-invalid"},ce={class:"mb-3"},ue={for:"question-input-type",class:"form-label"},ve=["disabled"],_e=["value"],me=["value"],pe=["value"],be=["value"],fe={key:0,class:"invalid-feedback is-invalid"},he={class:"mb-3"},ye={for:"question-input-position",class:"form-label"},ge=["data-bs-content"],xe=["disabled"],Ce={key:0,class:"invalid-feedback is-invalid"},Qe=["disabled"];function ke(m,i,u,e,v,p){return r(),J(e.AppContainer,{test_id:u.test_id},{default:K(()=>{var d;return[t("div",te,[t("div",oe,[t("div",se,o(e.t("Create Question")),1),e.serverErrors.length?(r(),a("div",ie,[t("ul",null,[(r(!0),a(x,null,W(e.serverErrors,s=>(r(),a("li",{key:s},o(s),1))),128))])])):_("",!0),t("div",ne,o((d=e.test)==null?void 0:d.name),1),t("div",re,[t("label",ae,o(e.t("Question")),1),C(t("input",{type:"text",class:Q(["form-control",{"is-invalid":e.errors.text}]),id:"question-input-text","onUpdate:modelValue":i[0]||(i[0]=s=>e.text=s),disabled:e.submitting},null,10,le),[[V,e.text]]),e.errors.text?(r(),a("div",de,o(e.errors.text),1)):_("",!0)]),t("div",ce,[t("label",ue,o(e.t("Question Type")),1),C(t("select",{class:Q(["form-select",{"is-invalid":e.errors.type}]),id:"question-input-type","onUpdate:modelValue":i[1]||(i[1]=s=>e.type=s),disabled:e.submitting},[t("option",{value:e.QuestionType.Text},o(e.t("Text")),9,_e),t("option",{value:e.QuestionType.MultipleChoice},o(e.t("Multiple Choice")),9,me),t("option",{value:e.QuestionType.Number},o(e.t("Number")),9,pe),t("option",{value:e.QuestionType.SingleChoice},o(e.t("Single Choice")),9,be)],10,ve),[[X,e.type]]),e.errors.type?(r(),a("div",fe,o(e.errors.type),1)):_("",!0)]),t("div",he,[t("label",ye,o(e.t("Position")),1),t("span",{class:"label-info","data-bs-content":e.t("The position of the question in the test.")},i[3]||(i[3]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,ge),C(t("input",{type:"number",class:Q(["form-control",{"is-invalid":e.errors.position}]),id:"question-input-position","onUpdate:modelValue":i[2]||(i[2]=s=>e.position=s),disabled:e.submitting},null,10,xe),[[V,e.position]]),e.errors.position?(r(),a("div",Ce,o(e.errors.position),1)):_("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:e.createQuestion,disabled:e.submitting},[e.submitting?(r(),a(x,{key:1},[A(o(e.t("Creating"))+" ...",1)],64)):(r(),a(x,{key:0},[A(o(e.t("Create")),1)],64))],8,Qe)])])]}),_:1},8,["test_id"])}const Ve=H(ee,[["render",ke],["__scopeId","data-v-9847bc67"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/CreateQuestionView.vue"]]);export{Ve as default};
