import{d as O,q as U,g as P,u as B,r as n,c as F,h as j,i as z,P as I,j as L,_ as R,l as G,w as H,o as r,b as i,a,F as g,m as J,t as u,e as m,x as v,aa as K,n as k,y as A,ab as W,z as M}from"./index-DgVFOuIu.js";import{a as X,b as Y}from"./testService-B9g0yUeR.js";import{Q as N}from"./Question-DJVAB3JS.js";import{A as Z}from"./AppContainer-B7WmBWY1.js";import"./firestore-CKAN35Ge.js";import"./Breadcrumb-0WoaLxXW.js";const $=O({__name:"CreateChoiceView",props:{test_id:{type:String,required:!0},question_id:{type:String,required:!0}},setup(l,{expose:t}){t();const c=U(),{showMessage:e}=P(),{auth:b}=B(),{getQuestion:p}=X(),{addChoice:s}=Y(),S=n(""),f=n(N.Text),h=n(""),_=n(0),T=n(!1),y=n(0),C=n(!1),d=n(!1),q=n([]),w=F(()=>{const o={};return C.value&&(h.value===""&&(o.text="Choice required"),typeof _.value=="string"&&(o.points="Max points must be a number"),typeof y.value=="string"&&(o.position="The position must be a number")),o}),E=j(b,async()=>{try{const o=await p(l.test_id,l.question_id);if(!o){e("failure","Question Not Found.");return}S.value=o.text,f.value=o.type}catch{e("failure","Error loading question.")}finally{}}),x=[];z(()=>{document.querySelectorAll(".app-main .label-info").forEach(D=>{x.push(new I(D,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),L(()=>{x.forEach(o=>o.dispose()),E()});async function Q(){if(!d.value){if(d.value=!0,C.value=!0,Object.keys(w.value).length>0){d.value=!1;return}try{await s(l.test_id,l.question_id,{text:h.value,points:Number(_.value),is_correct:T.value,position:Number(y.value),question:{type:f.value}}),q.value=[],c.push({name:"edit-question",params:{test_id:l.test_id,question_id:l.question_id},query:{sF:0}})}catch(o){q.value=["Server Error: "+o.code]}finally{d.value=!1}}}const V={router:c,showMessage:e,auth:b,getQuestion:p,addChoice:s,questionText:S,questionType:f,text:h,points:_,correctness:T,position:y,submitted:C,submitting:d,serverErrors:q,errors:w,onAuthEventDispose:E,popOvers:x,createChoice:Q,get QuestionType(){return N},AppContainer:Z};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),ee={class:"app-main"},te={class:"choice-form"},ie={key:0,class:"alert alert-danger",role:"alert"},oe={class:"mb-3 question-text"},se={class:"mb-3"},ne=["type","disabled"],re={key:0,class:"invalid-feedback is-invalid"},ae={class:"mb-3"},le=["disabled"],ce={key:0,class:"invalid-feedback is-invalid"},de={class:"mb-3"},ue={class:"form-check"},me={class:"mb-3"},ve=["disabled"],be={key:0,class:"invalid-feedback is-invalid"},pe=["disabled"];function fe(l,t,c,e,b,p){return r(),G(e.AppContainer,{test_id:c.test_id,question_id:c.question_id},{default:H(()=>[i("div",ee,[i("div",te,[t[9]||(t[9]=i("div",{class:"choice-form-title mb-4"},"Create Choice",-1)),e.serverErrors.length?(r(),a("div",ie,[i("ul",null,[(r(!0),a(g,null,J(e.serverErrors,s=>(r(),a("li",{key:s},u(s),1))),128))])])):m("",!0),i("div",oe,u(e.questionText),1),i("div",se,[t[4]||(t[4]=i("label",{for:"choice-input-text",class:"form-label"},"Choice",-1)),v(i("input",{type:e.questionType===e.QuestionType.Number?"number":"text",class:k(["form-control",{"is-invalid":e.errors.text}]),id:"choice-input-text","onUpdate:modelValue":t[0]||(t[0]=s=>e.text=s),disabled:e.submitting},null,10,ne),[[K,e.text]]),e.errors.text?(r(),a("div",re,u(e.errors.text),1)):m("",!0)]),i("div",ae,[t[5]||(t[5]=i("label",{for:"choice-input-pts",class:"form-label"},"Points",-1)),v(i("input",{type:"number",class:k(["form-control",{"is-invalid":e.errors.points}]),id:"choice-input-pts","onUpdate:modelValue":t[1]||(t[1]=s=>e.points=s),disabled:e.submitting},null,10,le),[[A,e.points]]),e.errors.points?(r(),a("div",ce,u(e.errors.points),1)):m("",!0)]),i("div",de,[i("div",ue,[v(i("input",{class:"form-check-input",type:"checkbox",id:"choice-input-correctness","onUpdate:modelValue":t[2]||(t[2]=s=>e.correctness=s)},null,512),[[W,e.correctness]]),t[6]||(t[6]=i("label",{class:"form-check-label",for:"choice-input-correctness"}," Correct Choice ",-1))])]),i("div",me,[t[7]||(t[7]=i("label",{for:"question-input-position",class:"form-label"},"Position",-1)),t[8]||(t[8]=i("span",{class:"label-info","data-bs-content":"The position of the choice in the question."},[i("i",{class:"bi bi-question-circle-fill"})],-1)),v(i("input",{type:"number",class:k(["form-control",{"is-invalid":e.errors.position}]),id:"question-input-position","onUpdate:modelValue":t[3]||(t[3]=s=>e.position=s),disabled:e.submitting},null,10,ve),[[A,e.position]]),e.errors.position?(r(),a("div",be,u(e.errors.position),1)):m("",!0)]),i("button",{type:"button",class:"btn btn-primary",onClick:e.createChoice,disabled:e.submitting},[e.submitting?(r(),a(g,{key:1},[M("Creating ...")],64)):(r(),a(g,{key:0},[M("Create")],64))],8,pe)])])]),_:1},8,["test_id","question_id"])}const ge=R($,[["render",fe],["__scopeId","data-v-dddaaafd"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/CreateChoiceView.vue"]]);export{ge as default};
