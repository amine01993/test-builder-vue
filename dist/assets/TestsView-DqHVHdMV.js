import{d as k,u as I,e as L,x as g,r as V,f as w,y as F,M as O,h as D,_ as C,i as j,o as p,c as b,j as t,t as m,n as B,a as f,p as v,F as h,b as H,g as N,R as U,k as P,m as z,z as Y}from"./index-D8XsmG4l.js";import{A as q,a as G}from"./AppMenu-BzvpNq4T.js";import{u as M}from"./testService-CcQ_rApu.js";const J=k({__name:"TestItem",props:{test:{type:Object,required:!0}},setup(a,{expose:e}){e();const n=I(),{showMessage:s}=L(),{deleteTest:d}=M(),l=g("test-description"),o=g("confirm-deletion-modal"),c=V(!1),u=new Date;let i=null;const x=w(()=>c.value?a.test.description.replace(/\n/g,"<br />"):a.test.description.replace(/\n/g,"")),S=w(()=>{const r=a.test.updated_at.toDate();return new Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:u.getFullYear()===r.getFullYear()?void 0:"numeric",hour:"numeric",minute:"numeric"}).format(r)});F(()=>{l.value&&l.value.addEventListener("click",_),o.value&&(i=new O(o.value))}),D(()=>{l.value&&l.value.removeEventListener("click",_),i&&i.dispose()});function _(){c.value=!0}function A(){i&&i.show()}async function R(){if(i&&i.hide(),a.test.id)try{await d(a.test.id),console.log("test deleted with success"),s("success","Test deleted with success.")}catch(r){console.log("test deletion error",r),s("failure","Test can not be deleted.")}finally{}}function E(){const r=n.resolve({name:"test-portal",params:{test_id:a.test.id}}),T=location.origin+r.fullPath;console.log("testLink",T),navigator.clipboard.writeText(T).then(()=>{console.log("copyTestLink.then"),s("success","Test link copied!")}).catch(()=>{console.log("copyTestLink.catch"),s("failure","Sorry, Test link couldn't be copied!")})}const y={router:n,showMessage:s,deleteTest:d,testDescriptionEl:l,testConfirmDeletionModalEl:o,showMore:c,currentDate:u,get testConfirmDeletionModal(){return i},set testConfirmDeletionModal(r){i=r},description:x,updatedAt:S,showMoreDescription:_,confirmTestdeletion:A,deleteDTest:R,copyTestLink:E};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),K={class:"test-item-container"},Q={class:"test-item-content"},W={class:"test-item-title"},X={class:"test-item-info"},Z=["innerHTML"],$={class:"test-property"},tt={class:"test-property"},et={class:"test-last-update"},st={class:"test-item-actions"},nt={class:"modal",tabindex:"-1",ref:"confirm-deletion-modal"},ot={class:"modal-dialog modal-dialog-centered"},it={class:"modal-content"},at={class:"modal-body"};function lt(a,e,n,s,d,l){const o=j("RouterLink");return p(),b(h,null,[t("div",K,[t("div",Q,[t("div",W,m(n.test.name),1),e[4]||(e[4]=t("hr",{class:"test-item-divider"},null,-1)),t("div",X,[t("div",{class:B(["test-description",{"full-text":s.showMore}]),ref:"test-description",innerHTML:s.description},null,10,Z),t("div",$,"Max Score: "+m(n.test.max_points),1),t("div",tt,"Time Limit: "+m(n.test.time_limit),1),t("div",et,"Last updated at: "+m(s.updatedAt),1)]),e[5]||(e[5]=t("hr",{class:"test-item-divider"},null,-1)),t("div",st,[f(o,{to:{name:"view-test",params:{test_id:n.test.id}},class:"btn btn-primary"},{default:v(()=>e[0]||(e[0]=[t("i",{class:"bi bi-eye-fill"},null,-1)])),_:1},8,["to"]),f(o,{to:{name:"edit-test",params:{test_id:n.test.id}},class:"btn btn-success"},{default:v(()=>e[1]||(e[1]=[t("i",{class:"bi bi-pencil-fill"},null,-1)])),_:1},8,["to"]),t("button",{type:"button",class:"btn btn-danger",onClick:s.confirmTestdeletion},e[2]||(e[2]=[t("i",{class:"bi bi-trash3-fill"},null,-1)])),t("button",{type:"button",class:"btn btn-warning",onClick:s.copyTestLink},e[3]||(e[3]=[t("i",{class:"bi bi-copy"},null,-1)]))])])]),t("div",nt,[t("div",ot,[t("div",it,[e[7]||(e[7]=t("div",{class:"modal-header"},[t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",at,[t("p",null,"Are you sure you want to delete this test: "+m(n.test.name)+"?",1)]),t("div",{class:"modal-footer"},[e[6]||(e[6]=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),t("button",{type:"button",class:"btn btn-danger",onClick:s.deleteDTest},"Delete")])])])],512)],64)}const rt=C(J,[["render",lt],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/components/items/TestItem.vue"]]),dt=k({__name:"TestsView",setup(a,{expose:e}){e();const{startLoading:n,endLoading:s}=L(),{auth:d}=H(),{tests:l,loadTests:o}=M(),c=N(d,async i=>{console.log("Testsview onAuthStateChanged",i),n(),await o(i.uid),s()});D(()=>{c()});const u={startLoading:n,endLoading:s,auth:d,tests:l,loadTests:o,onAuthEventDispose:c,get RouterLink(){return U},AppHeader:q,AppMenu:G,TestItem:rt};return Object.defineProperty(u,"__isScriptSetup",{enumerable:!1,value:!0}),u}}),ct={class:"app-main"},ut={class:"test-actions"},mt={class:"test-list"};function ft(a,e,n,s,d,l){return p(),b(h,null,[f(s.AppHeader),f(s.AppMenu),t("div",ct,[t("div",ut,[f(s.RouterLink,{to:{name:"create-test"},class:"btn btn-warning create-test"},{default:v(()=>e[0]||(e[0]=[z("Create New Test")])),_:1})]),t("div",mt,[(p(!0),b(h,null,P(s.tests,o=>(p(),Y(s.TestItem,{test:o,key:o.id},null,8,["test"]))),128))])])],64)}const vt=C(dt,[["render",ft],["__scopeId","data-v-8faed77a"],["__file","C:/Users/erram/OneDrive/Documents/test-builder-vue/src/views/TestsView.vue"]]);export{vt as default};
