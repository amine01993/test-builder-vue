const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ChoiceItem-BW61d41b.js","assets/index-Cr91u6jy.js","assets/index-Comk1Z5G.css","assets/choiceItem-C4uv2Qsc.js","assets/testService-jt7isDs9.js","assets/firestore-CQCayiu2.js","assets/Question-DJVAB3JS.js","assets/ChoiceItemD-C2yifamn.js"])))=>i.map(i=>d[i]);
import{d as ae,u as le,b as ue,v as de,a as re,r as p,x as ce,o as ve,c as he,P as _e,e as pe,f as V,w as S,L as me,y as fe,z as be,g as l,h as t,m as b,t as s,i as e,j as u,F as m,k as T,p as k,C as q,A as Q,B as U,T as ye,l as E,I as B,q as z,_ as j,s as ge}from"./index-Cr91u6jy.js";import{d as $}from"./vuedraggable.umd-CiB_ULPe.js";import{u as ke,a as qe,b as Ee}from"./testService-jt7isDs9.js";import{Q as x}from"./Question-DJVAB3JS.js";import{_ as xe}from"./AppContainer.vue_vue_type_script_setup_true_lang-Bo-b2LcD.js";import"./firestore-CQCayiu2.js";const Ce={class:"app-main"},we={class:"question-form-title mb-4"},Se=["aria-label"],Ve={key:0,class:"alert alert-danger",role:"alert"},Te={class:"mb-3 test-name"},Qe={class:"mb-3"},Le={for:"question-input-text",class:"form-label"},Pe=["disabled","tabindex"],Ne={key:0,class:"invalid-feedback is-invalid"},Ae={class:"mb-3"},Fe={for:"question-input-type",class:"form-label"},De=["disabled","tabindex"],Ie=["value"],Me=["value"],Re=["value"],Oe=["value"],Ue={key:0,class:"invalid-feedback is-invalid"},Be={class:"mb-3"},ze={for:"question-input-position",class:"form-label"},je=["data-bs-content","aria-label","tabindex"],$e=["disabled","tabindex"],Ge={key:0,class:"invalid-feedback is-invalid"},He=["disabled","tabindex"],Je={class:"choice-actions"},Ke={key:0,class:"choice-info"},We={key:0,class:"placeholder-wave"},Xe={class:"choice-info-label"},Ye={key:1,class:"choice-list"},Ze={key:2,class:"choice-list"},et={scope:"col"},tt={scope:"col"},ot={scope:"col"},st={scope:"col"},it={scope:"col"},nt={scope:"col"},at={key:1},lt=ae({__name:"EditQuestionView",props:{test_id:{},question_id:{}},setup(v){const{t:o}=le(),G=me(),L=fe(),{isDesktop:H,startLoading:J,endLoading:K,showMessage:_}=ue(),{spaceLabel:P}=de(),{auth:W}=re(),{test:N,loadTest:X}=ke(),{question:f,loadQuestion:Y,updateQuestion:Z}=qe(),{choices:r,loadChoices:ee,updateChoicesPositions:te}=Ee(),A=z(()=>j(()=>import("./ChoiceItem-BW61d41b.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),F=z(()=>j(()=>import("./ChoiceItemD-C2yifamn.js"),__vite__mapDeps([7,1,2,3,4,5,6]))),y=p(""),C=p(x.Text),g=p(0),d=p(G.query.sF!="0"),D=p(!1),h=p(!1),w=p([]),c=ce(()=>{const i={};return D.value&&(y.value.trim()===""&&(i.text=o("Question required")),typeof g.value=="string"&&(i.position=o("The position must be a number"))),i}),oe=ve(W,async()=>{d.value&&J();try{if(await X(v.test_id),!N.value){_("failure",o("Test Not Found."));return}}catch{_("failure",o("Error loading test."))}finally{}try{if(await Y(v.test_id,v.question_id),!f.value){_("failure",o("Question Not Found."));return}y.value=f.value.text,C.value=f.value.type,g.value=f.value.position}catch{_("failure",o("Error loading question data."))}finally{d.value&&K()}try{f.value&&await ee(v.test_id,f.value)}catch(i){console.log("EditQuestionView",i),_("failure",o("Error loading choices."))}}),I=[];he(()=>{document.querySelectorAll(".app-main .label-info").forEach(n=>{I.push(new _e(n,{container:"body",placement:"right",html:!0,trigger:"click"}))})}),pe(()=>{I.forEach(i=>i.dispose()),oe()});async function se(){if(!h.value){if(h.value=!0,D.value=!0,Object.keys(c.value).length>0){h.value=!1;return}try{await Z(v.test_id,v.question_id,{text:y.value.trim(),type:C.value,position:Number(g.value)}),w.value=[],_("success",o("Question edited with success.")),L.push({name:"edit-test",params:{test_id:v.test_id},query:{sF:0}})}catch(i){w.value=[o("Server Error")+P.value+": "+i.code]}finally{h.value=!1}}}function ie(){d.value=!d.value,L.push({query:{sF:d.value?1:0}})}function M(){te(v.test_id,v.question_id).then(()=>{_("success",o("Positions updated with success."))}).catch(i=>{_("failure",o("Sorry! Positions can not be updated."))})}return(i,n)=>{const ne=be("RouterLink");return l(),V(xe,{test_id:i.test_id},{default:S(()=>{var R,O;return[t("div",Ce,[t("div",{class:b(["question-form",{"hide-form":!d.value}])},[t("div",we,s(e(o)("Edit Question")),1),t("button",{class:"btn toggle-form-btn",onClick:ie,"aria-label":d.value?e(o)("hide editing form"):e(o)("show editing form")},[t("i",{class:b(["bi",{"bi-chevron-down":!d.value,"bi-chevron-up":d.value}])},null,2)],8,Se),w.value.length?(l(),u("div",Ve,[t("ul",null,[(l(!0),u(m,null,T(w.value,a=>(l(),u("li",{key:a},s(a),1))),128))])])):k("",!0),t("div",Te,s((R=e(N))==null?void 0:R.name),1),t("div",Qe,[t("label",Le,[q(s(e(o)("Question")),1),n[5]||(n[5]=t("span",{class:"required"},"*",-1))]),Q(t("input",{type:"text",class:b(["form-control",{"is-invalid":c.value.text}]),id:"question-input-text","onUpdate:modelValue":n[0]||(n[0]=a=>y.value=a),disabled:h.value,tabindex:d.value?void 0:-1,"aria-required":""},null,10,Pe),[[U,y.value]]),c.value.text?(l(),u("div",Ne,s(c.value.text),1)):k("",!0)]),t("div",Ae,[t("label",Fe,s(e(o)("Question Type")),1),Q(t("select",{class:b(["form-select",{"is-invalid":c.value.type}]),id:"question-input-type","onUpdate:modelValue":n[1]||(n[1]=a=>C.value=a),disabled:h.value,tabindex:d.value?void 0:-1},[t("option",{value:e(x).Text},s(e(o)("Text")),9,Ie),t("option",{value:e(x).MultipleChoice},s(e(o)("Multiple Choice")),9,Me),t("option",{value:e(x).Number},s(e(o)("Number")),9,Re),t("option",{value:e(x).SingleChoice},s(e(o)("Single Choice")),9,Oe)],10,De),[[ye,C.value]]),c.value.type?(l(),u("div",Ue,s(c.value.type),1)):k("",!0)]),t("div",Be,[t("label",ze,s(e(o)("Position")),1),t("button",{class:"label-info","data-bs-content":e(o)("The position of the question in the test."),"aria-label":e(o)("The position of the question in the test."),tabindex:d.value?void 0:-1},n[6]||(n[6]=[t("i",{class:"bi bi-question-circle-fill"},null,-1)]),8,je),Q(t("input",{type:"number",class:b(["form-control",{"is-invalid":c.value.position}]),id:"question-input-position","onUpdate:modelValue":n[2]||(n[2]=a=>g.value=a),disabled:h.value,tabindex:d.value?void 0:-1},null,10,$e),[[U,g.value]]),c.value.position?(l(),u("div",Ge,s(c.value.position),1)):k("",!0)]),t("button",{type:"button",class:"btn btn-primary",onClick:se,disabled:h.value,tabindex:d.value?void 0:-1},[h.value?(l(),u(m,{key:1},[q(s(e(o)("Editing"))+" ...",1)],64)):(l(),u(m,{key:0},[q(s(e(o)("Edit")),1)],64))],8,He)],2)]),t("div",Je,[E(ne,{to:{name:"create-choice",params:{test_id:i.test_id,question_id:i.question_id}},class:"btn btn-warning"},{default:S(()=>[q(s(e(o)("Create New Choice")),1)]),_:1},8,["to"])]),!e(r)||e(r).length>0?(l(),u("div",Ke,[e(r)?(l(),u(m,{key:1},[t("span",Xe,s(e(o)("Total number of choices"))+s(e(P))+":",1),q(" "+s((O=e(r))==null?void 0:O.length),1)],64)):(l(),u("div",We,n[7]||(n[7]=[t("div",{class:"placeholder placeholder-lg col-8 bg-secondary"},null,-1)])))])):k("",!0),e(H)?(l(),u("div",Ze,[t("table",{class:b(["table",{loading:!e(r)}])},[t("thead",null,[t("tr",null,[n[8]||(n[8]=t("th",{scope:"col"},null,-1)),t("th",et,s(e(o)("Choice")),1),t("th",tt,s(e(o)("Points")),1),t("th",ot,s(e(o)("Is Correct?")),1),t("th",st,s(e(o)("Position")),1),t("th",it,s(e(o)("Last updated at")),1),t("th",nt,s(e(o)("Actions")),1)])]),e(r)?(l(),V(e($),{key:0,modelValue:e(r),"onUpdate:modelValue":n[4]||(n[4]=a=>B(r)?r.value=a:null),"item-key":"id",tag:"tbody",handle:".choice-item-sort-handler",onEnd:M},{item:S(({element:a})=>[E(e(F),{test_id:i.test_id,question_id:i.question_id,choice:a},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(l(),u("tbody",at,[(l(),u(m,null,T(5,a=>E(e(F),{key:"choice-placeholder-"+a})),64))]))],2)])):(l(),u(m,{key:1},[e(r)?(l(),V(e($),{key:0,modelValue:e(r),"onUpdate:modelValue":n[3]||(n[3]=a=>B(r)?r.value=a:null),"item-key":"id",tag:"div","component-data":{class:"choice-list"},handle:".choice-item-sort-handler",onEnd:M},{item:S(({element:a})=>[E(e(A),{test_id:i.test_id,question_id:i.question_id,choice:a},null,8,["test_id","question_id","choice"])]),_:1},8,["modelValue"])):(l(),u("div",Ye,[(l(),u(m,null,T([0,1,2],a=>E(e(A),{key:"choice-placeholder-"+a})),64))]))],64))]}),_:1},8,["test_id"])}}}),_t=ge(lt,[["__scopeId","data-v-458fcd8b"]]);export{_t as default};
